<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>vue3笔记 | 前端知识点记录</title>
  <meta name="keywords" content="">
  <meta name="description" content="vue3笔记 | 前端知识点记录">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="baidu-site-verification" content="codeva-LecjeKsg4q" />
<meta name="msvalidate.01" content="BDC4733A72EDADC029644A0AB0A022AD" />
<meta name="description" content="导航 爱达杂货铺 | 收集那些有用的东西|爱达导航 (adzhp.net) Jay的资源库 | 互联网资源集大成者 (lovejay.top) 数字生活指南 | 让工作学习生活更高效！guidebook.top 迷鹿导航 (404l.com) 喵趣导航 | 更好用的导航 (meowa.cn)  免费的多合一在线PDF工具 软件SOS_玩机手册，软件安装管家_软件激活工具下载 (rjsos.com)">
<meta property="og:type" content="article">
<meta property="og:title" content="网站、论坛合集">
<meta property="og:url" content="http://example.com/2023/02/28/%E7%BD%91%E7%AB%99%E3%80%81%E8%AE%BA%E5%9D%9B%E5%90%88%E9%9B%86/index.html">
<meta property="og:site_name" content="前端知识点记录">
<meta property="og:description" content="导航 爱达杂货铺 | 收集那些有用的东西|爱达导航 (adzhp.net) Jay的资源库 | 互联网资源集大成者 (lovejay.top) 数字生活指南 | 让工作学习生活更高效！guidebook.top 迷鹿导航 (404l.com) 喵趣导航 | 更好用的导航 (meowa.cn)  免费的多合一在线PDF工具 软件SOS_玩机手册，软件安装管家_软件激活工具下载 (rjsos.com)">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-02-28T07:20:18.000Z">
<meta property="article:modified_time" content="2023-03-02T03:21:44.981Z">
<meta property="article:author" content="Feng">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Feng</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/fengqichang666"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="facebook"
               href="https://www.facebook.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-facebook"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
            <a title="instagram"
               href="https://www.facebook.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-instagram"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="reddit"
               href="https://www.reddit.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-reddit"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="weibo"
               href="http://weibo.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-weibo"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="jianshu"
               href="https://www.jianshu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-jianshu"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="zhihu"
               href="https://www.zhihu.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-zhihu"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="oschina"
               href="https://my.oschina.net/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-oschina"></use>
                    </svg>
                
            </a>
        
    
        
    
        
            <a title="email"
               href="mailto:2309997549@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=2309997549&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="kugou"
               href="https://www.kugou.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-kugou"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="neteasemusic"
               href="https://music.163.com/"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-neteasemusic"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(41)</small>
            
        </div>
    </li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="41">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://wgrape.github.io/">WGrape</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>常用的正则表达式大全</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>构造函数、原型对象、对象实例</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>前端性能优化面试题</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git操作指令大全</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Proxy和Object.defineProperty</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vue</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All "
           href="/2023/02/28/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="前端学习资料">前端学习资料</span>
            <span class="post-date" title="2023-02-28 15:28:27">2023/02/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/28/%E5%AF%BC%E8%88%AA%E8%81%9A%E5%90%88%E7%BD%91%E7%AB%99/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="网站、论坛合集">网站、论坛合集</span>
            <span class="post-date" title="2023-02-28 15:20:18">2023/02/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/28/%E7%BD%91%E7%AB%99%E3%80%81%E8%AE%BA%E5%9D%9B%E5%90%88%E9%9B%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="网站、论坛合集">网站、论坛合集</span>
            <span class="post-date" title="2023-02-28 15:20:18">2023/02/28</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/24/vue%E5%AF%B9%E6%95%B0%E7%BB%84%E7%9A%84%E5%A4%84%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue对数组的处理">vue对数组的处理</span>
            <span class="post-date" title="2023-02-24 13:53:03">2023/02/24</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/23/vue%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86%E5%8F%8A%E6%94%B6%E9%9B%86%E4%BE%9D%E8%B5%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue响应式原理、依赖收集">vue响应式原理、依赖收集</span>
            <span class="post-date" title="2023-02-23 09:38:38">2023/02/23</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/21/webpack%E7%AC%94%E8%AE%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="webpack笔记">webpack笔记</span>
            <span class="post-date" title="2023-02-21 14:43:08">2023/02/21</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/21/react%E7%AC%94%E8%AE%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="react笔记">react笔记</span>
            <span class="post-date" title="2023-02-21 14:43:02">2023/02/21</span>
        </a>
        
        
        <a  class="All "
           href="/2023/02/21/uniapp%E7%AC%94%E8%AE%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="uniapp笔记">uniapp笔记</span>
            <span class="post-date" title="2023-02-21 14:42:53">2023/02/21</span>
        </a>
        
        
        <a  class="All "
           href="/2023/01/11/JS%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="工具函数">工具函数</span>
            <span class="post-date" title="2023-01-11 17:09:41">2023/01/11</span>
        </a>
        
        
        <a  class="All "
           href="/2023/01/11/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95SSO/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="单点登录SSO">单点登录SSO</span>
            <span class="post-date" title="2023-01-11 13:56:41">2023/01/11</span>
        </a>
        
        
        <a  class="All "
           href="/2023/01/11/%E5%89%8D%E7%AB%AF%E9%89%B4%E6%9D%83cookie%E3%80%81session%E3%80%81token%E3%80%81jwt%E3%80%81%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="前端鉴权cookie、session、token、jwt、单点登录">前端鉴权cookie、session、token、jwt、单点登录</span>
            <span class="post-date" title="2023-01-11 10:13:51">2023/01/11</span>
        </a>
        
        
        <a  class="All "
           href="/2022/12/22/%E7%BB%84%E4%BB%B6%E5%BA%93%E5%BC%80%E5%8F%91/"
           data-tag="vue"
           data-author="" >
            <span class="post-title" title="组件库开发">组件库开发</span>
            <span class="post-date" title="2022-12-22 15:17:36">2022/12/22</span>
        </a>
        
        
        <a  class="All "
           href="/2022/12/22/pinia/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="pinia">pinia</span>
            <span class="post-date" title="2022-12-22 10:55:10">2022/12/22</span>
        </a>
        
        
        <a  class="All "
           href="/2022/12/21/router4%E7%AC%94%E8%AE%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="router4笔记">router4笔记</span>
            <span class="post-date" title="2022-12-21 17:02:33">2022/12/21</span>
        </a>
        
        
        <a  class="All "
           href="/2022/12/15/vue3%E7%AC%94%E8%AE%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue3笔记">vue3笔记</span>
            <span class="post-date" title="2022-12-15 15:00:16">2022/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2022/11/15/git-HEAD-%E4%B8%8EHEAD-%E7%9A%84%E5%8C%BA%E5%88%AB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="git HEAD~与HEAD^的区别">git HEAD~与HEAD^的区别</span>
            <span class="post-date" title="2022-11-15 14:17:58">2022/11/15</span>
        </a>
        
        
        <a  class="All "
           href="/2022/10/08/%E5%BC%80%E5%8F%91%E4%B8%AD%E5%AE%B9%E6%98%93%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="开发中容易遇到的问题">开发中容易遇到的问题</span>
            <span class="post-date" title="2022-10-08 16:30:35">2022/10/08</span>
        </a>
        
        
        <a  class="All "
           href="/2022/09/22/js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="js执行机制">js执行机制</span>
            <span class="post-date" title="2022-09-22 16:08:28">2022/09/22</span>
        </a>
        
        
        <a  class="All "
           href="/2022/09/19/vue-elementui-%E8%A1%A8%E5%8D%95%E6%A3%80%E9%AA%8C%E4%B8%AD%E5%8F%91%E9%80%81%E6%8E%A5%E5%8F%A3%E8%BF%9B%E8%A1%8C%E6%A0%A1%E9%AA%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue+elementui 表单检验中发送接口进行校验">vue+elementui 表单检验中发送接口进行校验</span>
            <span class="post-date" title="2022-09-19 19:30:51">2022/09/19</span>
        </a>
        
        
        <a  class="All "
           href="/2022/09/19/eslint%E4%BD%BF%E7%94%A8%E3%80%81%E6%8A%A5%E9%94%99%E9%83%A8%E5%88%86%E5%BF%AB%E9%80%9F%E4%BF%AE%E5%A4%8D/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue-cli中eslint检验指定文件/夹、报错部分快速修复">vue-cli中eslint检验指定文件/夹、报错部分快速修复</span>
            <span class="post-date" title="2022-09-19 19:28:46">2022/09/19</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/17/%E9%87%91%E9%A2%9D%E8%BE%93%E5%85%A5%E6%A1%86%E5%B0%81%E8%A3%85%EF%BC%88%E5%8D%83%E5%88%86%E4%BD%8D%EF%BC%8C%E7%A6%81%E6%AD%A2%E4%B8%AD%E6%96%87%E8%BE%93%E5%85%A5%EF%BC%89/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="金额输入框封装（千分位，禁止中文输入）">金额输入框封装（千分位，禁止中文输入）</span>
            <span class="post-date" title="2022-07-17 16:34:55">2022/07/17</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/17/%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6keydown%EF%BC%8Ckeypress%EF%BC%8Ckeyup/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="键盘事件keydown，keypress，keyup">键盘事件keydown，keypress，keyup</span>
            <span class="post-date" title="2022-07-17 11:46:10">2022/07/17</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/03/nodejs-websocket/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="nodejs-websocket">nodejs-websocket</span>
            <span class="post-date" title="2022-07-03 13:13:15">2022/07/03</span>
        </a>
        
        
        <a  class="All "
           href="/2022/06/19/Git%E5%87%AD%E6%8D%AE%E7%AE%A1%E7%90%86%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F-https/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git凭据管理的三种方式(https)">Git凭据管理的三种方式(https)</span>
            <span class="post-date" title="2022-06-19 11:56:57">2022/06/19</span>
        </a>
        
        
        <a  class="All "
           href="/2022/06/19/git-merge-no-ff-%E4%B8%8E-ff-%E5%92%8C-squash%E7%9A%84%E5%8C%BA%E5%88%AB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="git merge --no-ff 与--ff 和--squash的区别">git merge --no-ff 与--ff 和--squash的区别</span>
            <span class="post-date" title="2022-06-19 11:18:58">2022/06/19</span>
        </a>
        
        
        <a  class="All "
           href="/2021/12/08/vue3+elementplus+ts+pinia%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue3+elementplus+ts+pinia踩坑记录">vue3+elementplus+ts+pinia踩坑记录</span>
            <span class="post-date" title="2021-12-08 15:23:24">2021/12/08</span>
        </a>
        
        
        <a  class="All "
           href="/2021/12/08/vue%E7%9F%A5%E8%AF%86%E7%82%B9%E8%AE%B0%E5%BD%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue知识点记录">vue知识点记录</span>
            <span class="post-date" title="2021-12-08 15:23:24">2021/12/08</span>
        </a>
        
        
        <a  class="All "
           href="/2021/12/08/vue%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6css%E4%BF%AE%E6%94%B9/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue第三方组件css修改">vue第三方组件css修改</span>
            <span class="post-date" title="2021-12-08 14:00:41">2021/12/08</span>
        </a>
        
        
        <a  class="All "
           href="/2021/11/25/vuex/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vuex">vuex</span>
            <span class="post-date" title="2021-11-25 15:56:11">2021/11/25</span>
        </a>
        
        
        <a  class="All "
           href="/2021/10/25/commonJS%E4%B8%8Ees6%E6%A8%A1%E5%9D%97%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="exports、module.exports和export、export default">exports、module.exports和export、export default</span>
            <span class="post-date" title="2021-10-25 13:41:29">2021/10/25</span>
        </a>
        
        
        <a  class="All "
           href="/2021/10/08/%E8%99%9A%E6%8B%9FDOM%E4%B8%8EDIFF%E7%AE%97%E6%B3%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="虚拟DOM与DIFF算法">虚拟DOM与DIFF算法</span>
            <span class="post-date" title="2021-10-08 16:57:02">2021/10/08</span>
        </a>
        
        
        <a  class="All "
           href="/2021/09/24/%E8%AF%A6%E8%A7%A3mixins%E6%B7%B7%E5%85%A5%E4%BD%BF%E7%94%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="详解mixins混入使用">详解mixins混入使用</span>
            <span class="post-date" title="2021-09-24 17:10:18">2021/09/24</span>
        </a>
        
        
        <a  class="All "
           href="/2021/09/24/Vue%E4%B8%ADextend-mixins-extends%E4%BB%A5%E5%8F%8AVue-use%E7%9A%84install%E5%92%8CVue-nextTick/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Vue中extend,mixins,extends以及Vue.use的install和Vue.nextTick">Vue中extend,mixins,extends以及Vue.use的install和Vue.nextTick</span>
            <span class="post-date" title="2021-09-24 15:33:37">2021/09/24</span>
        </a>
        
        
        <a  class="All "
           href="/2021/07/20/vue%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="vue组件通信">vue组件通信</span>
            <span class="post-date" title="2021-07-20 11:00:15">2021/07/20</span>
        </a>
        
        
        <a  class="All "
           href="/2021/07/15/%E6%A0%B7%E5%BC%8F%E6%B8%85%E5%8D%95%E6%95%B4%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="样式清单整理">样式清单整理</span>
            <span class="post-date" title="2021-07-15 09:34:39">2021/07/15</span>
        </a>
        
        
        <a  class="All "
           href="/2021/07/07/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="数据类型判断">数据类型判断</span>
            <span class="post-date" title="2021-07-07 15:21:32">2021/07/07</span>
        </a>
        
        
        <a  class="All "
           href="/2021/07/07/Proxy%E5%92%8CObject-defineProperty/"
           data-tag="Proxy和Object.defineProperty"
           data-author="" >
            <span class="post-title" title="Proxy和Object.defineProperty">Proxy和Object.defineProperty</span>
            <span class="post-date" title="2021-07-07 10:31:00">2021/07/07</span>
        </a>
        
        
        <a  class="All "
           href="/2021/06/30/git%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4/"
           data-tag="git操作指令大全"
           data-author="" >
            <span class="post-title" title="git命令总结">git命令总结</span>
            <span class="post-date" title="2021-06-30 10:28:12">2021/06/30</span>
        </a>
        
        
        <a  class="All "
           href="/2021/06/30/%E5%B8%B8%E7%94%A8%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%A4%A7%E5%85%A8/"
           data-tag="常用的正则表达式大全"
           data-author="" >
            <span class="post-title" title="常用的正则表达式大全">常用的正则表达式大全</span>
            <span class="post-date" title="2021-06-30 10:28:12">2021/06/30</span>
        </a>
        
        
        <a  class="All "
           href="/2020/06/06/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E9%9D%A2%E8%AF%95%E9%A2%98/"
           data-tag="前端性能优化面试题"
           data-author="" >
            <span class="post-title" title="前端性能优化面试题总结">前端性能优化面试题总结</span>
            <span class="post-date" title="2020-06-06 15:33:46">2020/06/06</span>
        </a>
        
        
        <a  class="All "
           href="/2020/05/24/%E5%8E%9F%E5%9E%8B%E9%93%BE/"
           data-tag="构造函数、原型对象、对象实例"
           data-author="" >
            <span class="post-title" title="原型链">原型链</span>
            <span class="post-date" title="2020-05-24 10:40:00">2020/05/24</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-vue3笔记" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">vue3笔记</h1>
    
    <div class="article-meta">
        
        
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2023-03-03 15:39:40'>2022-12-15 15:00</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3-%E6%96%B0%E7%89%B9%E6%80%A7%E4%BB%8B%E7%BB%8D"><span class="toc-text">Vue3 新特性介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A"><span class="toc-text">重写双向绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3-%E4%BC%98%E5%8C%96Vdom"><span class="toc-text">Vue3 优化Vdom</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#patch-flag-%E4%BC%98%E5%8C%96%E9%9D%99%E6%80%81%E6%A0%91"><span class="toc-text">patch flag 优化静态树</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3-Fragment"><span class="toc-text">Vue3 Fragment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ref%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-text">Ref全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ref"><span class="toc-text">ref</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isRef"><span class="toc-text">isRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowRef%E3%80%81triggerRef"><span class="toc-text">shallowRef、triggerRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#customRef"><span class="toc-text">customRef</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reactive%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-text">Reactive全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#reactive"><span class="toc-text">reactive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readonly"><span class="toc-text">readonly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowReactive"><span class="toc-text">shallowReactive</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to%E7%B3%BB%E5%88%97%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-text">to系列全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#toRef"><span class="toc-text">toRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRefs"><span class="toc-text">toRefs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRaw"><span class="toc-text">toRaw</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#computed%E7%94%A8%E6%B3%95"><span class="toc-text">computed用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch%E4%BE%A6%E5%90%AC%E5%99%A8"><span class="toc-text">watch侦听器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watchEffect%E9%AB%98%E7%BA%A7%E4%BE%A6%E5%90%AC%E5%99%A8"><span class="toc-text">watchEffect高级侦听器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%89%AF%E4%BD%9C%E7%94%A8-oninvalidate"><span class="toc-text">清除副作用 oninvalidate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%AF%E4%BD%9C%E7%94%A8%E5%88%B7%E6%96%B0%E6%97%B6%E6%9C%BA-flush-%E4%B8%80%E8%88%AC%E4%BD%BF%E7%94%A8post"><span class="toc-text">副作用刷新时机 flush 一般使用post</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">组件的生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VNode-hooks"><span class="toc-text">VNode hooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82"><span class="toc-text">父子组件传参</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#defineProps"><span class="toc-text">defineProps </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defineEmits"><span class="toc-text">defineEmits</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defineExpose"><span class="toc-text">defineExpose</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5Provide-Inject"><span class="toc-text">依赖注入Provide &#x2F; Inject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82%E5%92%8CBus"><span class="toc-text">兄弟组件传参和Bus</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%9F%E5%8A%A9%E7%88%B6%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82"><span class="toc-text">借助父组件传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Event-Bus"><span class="toc-text">Event Bus</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6%EF%BC%8C%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6%EF%BC%8C%E9%80%92%E5%BD%92%E7%BB%84%E4%BB%B6"><span class="toc-text">全局组件，局部组件，递归组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6"><span class="toc-text">配置全局组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E6%B3%A8%E5%86%8C%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6"><span class="toc-text">批量注册全局组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6"><span class="toc-text">配置局部组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%80%92%E5%BD%92%E7%BB%84%E4%BB%B6"><span class="toc-text">配置递归组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%92%E6%A7%BDslot"><span class="toc-text">插槽slot</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-text">匿名插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-text">具名插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD"><span class="toc-text">作用域插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%8F%92%E6%A7%BD"><span class="toc-text">动态插槽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%AD%90%E7%BB%84%E4%BB%B6%E6%9A%B4%E9%9C%B2%E6%8F%92%E6%A7%BD"><span class="toc-text">从子组件暴露插槽</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6-amp-%E4%BB%A3%E7%A0%81%E5%88%86%E5%8C%85-amp-suspense"><span class="toc-text">异步组件&amp;代码分包&amp;suspense</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-text">异步组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#suspense"><span class="toc-text">suspense</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Teleport%E4%BC%A0%E9%80%81%E7%BB%84%E4%BB%B6"><span class="toc-text">Teleport传送组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keep-alive%E7%BC%93%E5%AD%98%E7%BB%84%E4%BB%B6"><span class="toc-text">keep-alive缓存组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transition%E5%8A%A8%E7%94%BB%E7%BB%84%E4%BB%B6"><span class="toc-text">transition动画组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%B8%A1%E7%9A%84%E7%B1%BB%E5%90%8D"><span class="toc-text">过渡的类名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%B8%A1-class-%E7%B1%BB%E5%90%8D"><span class="toc-text">自定义过渡 class 类名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#transition-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F8%E4%B8%AA"><span class="toc-text">transition 生命周期8个</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#appear"><span class="toc-text">appear</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transition-group%E8%BF%87%E5%BA%A6%E5%88%97%E8%A1%A8"><span class="toc-text">transition-group过度列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E7%9A%84%E7%A7%BB%E5%8A%A8%E8%BF%87%E6%B8%A1"><span class="toc-text">列表的移动过渡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%BF%87%E6%B8%A1"><span class="toc-text">状态过渡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5v-model"><span class="toc-text">深入v-model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E5%A4%9A%E4%B8%AA%E6%A1%88%E4%BE%8B"><span class="toc-text">绑定多个案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="toc-text">自定义修饰符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4directive-%E5%B1%9E%E4%BA%8E%E7%A0%B4%E5%9D%8F%E6%80%A7%E6%9B%B4%E6%96%B0"><span class="toc-text">自定义指令directive(属于破坏性更新)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vue3%E6%8C%87%E4%BB%A4%E7%9A%84%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0"><span class="toc-text">vue3指令的钩子函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8setup%E5%86%85%E5%AE%9A%E4%B9%89%E5%B1%80%E9%83%A8%E6%8C%87%E4%BB%A4"><span class="toc-text">在setup内定义局部指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-text">生命周期钩子参数详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%AE%80%E5%86%99"><span class="toc-text">函数简写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Hooks"><span class="toc-text">自定义Hooks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%87%BD%E6%95%B0%E5%92%8C%E5%8F%98%E9%87%8F"><span class="toc-text">Vue3定义全局函数和变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#globalProperties"><span class="toc-text">globalProperties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">过滤器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99Vue3%E6%8F%92%E4%BB%B6"><span class="toc-text">编写Vue3插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vue-use-%E6%BA%90%E7%A0%81%E6%89%8B%E5%86%99"><span class="toc-text">Vue use 源码手写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Scoped%E5%92%8C%E6%A0%B7%E5%BC%8F-%E7%A9%BF%E9%80%8F"><span class="toc-text">Scoped和样式 穿透</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#css-Style%E5%AE%8C%E6%95%B4%E6%96%B0%E7%89%B9%E6%80%A7"><span class="toc-text">css Style完整新特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD%E9%80%89%E6%8B%A9%E5%99%A8-slotted"><span class="toc-text">插槽选择器(slotted)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-text">全局选择器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81-CSS"><span class="toc-text">动态 CSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mitt"><span class="toc-text">Mitt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#main-ts-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">main.ts 初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E9%80%9A%E8%BF%87emit%E6%B4%BE%E5%8F%91%EF%BC%8C-on-%E6%96%B9%E6%B3%95%E6%B7%BB%E5%8A%A0%E4%BA%8B%E4%BB%B6%EF%BC%8Coff-%E6%96%B9%E6%B3%95%E7%A7%BB%E9%99%A4%EF%BC%8Cclear-%E6%B8%85%E7%A9%BA%E6%89%80%E6%9C%89"><span class="toc-text">使用方法通过emit派发， on 方法添加事件，off 方法移除，clear 清空所有</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%EF%BC%88-on-%E2%80%9C-%E2%80%9D-%EF%BC%89"><span class="toc-text">监听所有事件（ on(“*”) ）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC%E4%BA%8B%E4%BB%B6%EF%BC%88off%EF%BC%89"><span class="toc-text">移除监听事件（off）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E6%89%80%E6%9C%89%E7%9B%91%E5%90%AC%EF%BC%88clear%EF%BC%89"><span class="toc-text">清空所有监听（clear）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">环境变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%A2%9D%E5%A4%96%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">配置额外的环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8"><span class="toc-text">生产环境使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E6%9E%9C%E6%83%B3%E5%9C%A8vite-config-ts-%E4%BD%BF%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">如果想在vite.config.ts 使用环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy%E8%B7%A8%E5%9F%9F"><span class="toc-text">Proxy跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%A8%E5%9F%9F"><span class="toc-text">什么是跨域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-text">如何解决跨域</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Vue3-新特性介绍"><a href="#Vue3-新特性介绍" class="headerlink" title="Vue3 新特性介绍"></a>Vue3 新特性介绍</h2><h3 id="重写双向绑定"><a href="#重写双向绑定" class="headerlink" title="重写双向绑定"></a>重写双向绑定</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vue2</span><br><span class="line">基于Object.defineProperty()实现</span><br><span class="line"></span><br><span class="line">vue3 基于Proxy</span><br><span class="line">proxy与Object.defineProperty(obj, prop, desc)方式相比有以下优势：</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;丢掉麻烦的备份数据</span><br><span class="line">&#x2F;&#x2F;省去for in 循环</span><br><span class="line">&#x2F;&#x2F;可以监听数组变化</span><br><span class="line">&#x2F;&#x2F;代码更简化</span><br><span class="line">&#x2F;&#x2F;可以监听动态新增的属性；</span><br><span class="line">&#x2F;&#x2F;可以监听删除的属性 ；</span><br><span class="line">&#x2F;&#x2F;可以监听数组的索引和 length 属性；</span><br><span class="line">let proxyObj &#x3D; new Proxy(obj,&#123;</span><br><span class="line">    get : function (target,prop) &#123;</span><br><span class="line">        return prop in target ? target[prop] : 0</span><br><span class="line">    &#125;,</span><br><span class="line">    set : function (target,prop,value) &#123;</span><br><span class="line">        target[prop] &#x3D; 888;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Vue3-优化Vdom"><a href="#Vue3-优化Vdom" class="headerlink" title="Vue3 优化Vdom"></a>Vue3 优化Vdom</h2><p><strong>在Vue2中,每次更新diff,都是全量对比,Vue3则只对比带有标记的,这样大大减少了非动态内容的对比消耗</strong></p>
<h3 id="patch-flag-优化静态树"><a href="#patch-flag-优化静态树" class="headerlink" title="patch flag 优化静态树"></a>patch flag 优化静态树</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;Hello world!&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;Hello world!&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;Hello world!&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;Hello world!&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;&#123;&#123;msg&#125;&#125;&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;Hello world!&lt;&#x2F;span&gt;</span><br><span class="line">&lt;span&gt;Hello world! &lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure>

<p><code>Vue3</code> 编译后的 <code>Vdom</code> 是这个样子的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export function render(_ctx，_cache，$props，$setup，$data，$options)&#123;return (_openBlock(),_createBlock(_Fragment,null，[</span><br><span class="line">_createvNode( &quot;span&quot;, null,&quot;Hello world ! &quot;),</span><br><span class="line">_createvNode( &quot;span&quot;,null，&quot;Hello world! &quot;),</span><br><span class="line">_createvNode( &quot;span&quot;，null，&quot;Hello world! &quot;),</span><br><span class="line">_createvNode( &quot;span&quot;, null，&quot;Hello world! &quot;),</span><br><span class="line">_createVNode(&quot;span&quot;, null，_toDisplaystring(_ctx.msg)，1&#x2F;* TEXT *&#x2F;)，</span><br><span class="line">_createvNode( &quot;span&quot;, null，&quot;Hello world! &quot;),</span><br><span class="line">_createvNode( &quot;span&quot;, null，&quot;Hello world! &quot;)]，64&#x2F;*STABLE_FRAGMENT *&#x2F;))</span><br></pre></td></tr></table></figure>

<p>新增了 patch flag 标记</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">TEXT &#x3D; 1 &#x2F;&#x2F; 动态文本节点</span><br><span class="line">CLASS&#x3D;1&lt;&lt;1,1 &#x2F;&#x2F; 2&#x2F;&#x2F;动态class</span><br><span class="line">STYLE&#x3D;1&lt;&lt;2，&#x2F;&#x2F; 4 &#x2F;&#x2F;动态style</span><br><span class="line">PROPS&#x3D;1&lt;&lt;3,&#x2F;&#x2F; 8 &#x2F;&#x2F;动态属性，但不包含类名和样式</span><br><span class="line">FULLPR0PS&#x3D;1&lt;&lt;4,&#x2F;&#x2F; 16 &#x2F;&#x2F;具有动态key属性，当key改变时，需要进行完整的diff比较。</span><br><span class="line">HYDRATE_ EVENTS &#x3D; 1 &lt;&lt; 5，&#x2F;&#x2F; 32 &#x2F;&#x2F;带有监听事件的节点</span><br><span class="line">STABLE FRAGMENT &#x3D; 1 &lt;&lt; 6, &#x2F;&#x2F; 64 &#x2F;&#x2F;一个不会改变子节点顺序的fragment</span><br><span class="line">KEYED_ FRAGMENT &#x3D; 1 &lt;&lt; 7, &#x2F;&#x2F; 128 &#x2F;&#x2F;带有key属性的fragment 或部分子字节有key</span><br><span class="line">UNKEYED FRAGMENT &#x3D; 1&lt;&lt; 8, &#x2F;&#x2F; 256 &#x2F;&#x2F;子节点没有key 的fragment</span><br><span class="line">NEED PATCH &#x3D; 1 &lt;&lt; 9, &#x2F;&#x2F; 512 &#x2F;&#x2F;一个节点只会进行非props比较</span><br><span class="line">DYNAMIC_SLOTS &#x3D; 1 &lt;&lt; 10 &#x2F;&#x2F; 1024 &#x2F;&#x2F; 动态slot</span><br><span class="line">HOISTED &#x3D; -1 &#x2F;&#x2F; 静态节点</span><br><span class="line">BALL &#x3D; -2</span><br></pre></td></tr></table></figure>

<p>我们发现创建动态 dom 元素的时候，Vdom 除了模拟出来了它的基本信息之外，还给它加了一个标记： 1 /* TEXT */</p>
<p>这个标记就叫做 patch flag（补丁标记）</p>
<p>patch flag 的强大之处在于，当你的 diff 算法走到 _createBlock 函数的时候，会忽略所有的静态节点，只对有标记的动态节点进行对比，而且在多层的嵌套下依然有效。</p>
<p>尽管 JavaScript 做 Vdom 的对比已经非常的快，但是 patch flag 的出现还是让 Vue3 的 Vdom 的性能得到了很大的提升，尤其是在针对大组件的时候。</p>
<h2 id="Vue3-Fragment"><a href="#Vue3-Fragment" class="headerlink" title="Vue3 Fragment"></a>Vue3 Fragment</h2><p>vue3 允许我们支持多个根节点(vue将为我们创建一个虚拟的Fragment节点)、同时支持render JSX 写法</p>
<h2 id="Ref全家桶"><a href="#Ref全家桶" class="headerlink" title="Ref全家桶"></a>Ref全家桶</h2><h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><p>绑定普通的数据类型，如果用ref去绑定对象 或者 数组 等复杂的数据类型，源码里面其实也是 去调用reactive</p>
<p>接受一个内部值并返回一个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%93%8D%E5%BA%94%E5%BC%8F&spm=1001.2101.3001.7020">响应式</a>且可变的 ref 对象。ref 对象仅有一个 <code>.value</code> property，指向该内部值。</p>
<h3 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a>isRef</h3><p>判断是不是一个ref对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ref, Ref,isRef &#125; from &#39;vue&#39;</span><br><span class="line">let message: Ref&lt;string | number&gt; &#x3D; ref(&quot;我是message&quot;)</span><br><span class="line">let notRef:number &#x3D; 123</span><br><span class="line">const changeMsg &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  message.value &#x3D; &quot;change msg&quot;</span><br><span class="line"></span><br><span class="line">  console.log(isRef(message)); &#x2F;&#x2F;true</span><br><span class="line">  console.log(isRef(notRef)); &#x2F;&#x2F;false</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="shallowRef、triggerRef"><a href="#shallowRef、triggerRef" class="headerlink" title="shallowRef、triggerRef"></a>shallowRef、triggerRef</h3><p>shallowRef()存在的意义：将最终的结果输出到视图，节省一些不必要的输出。</p>
<p><strong>shallowRef是浅层响应式数据，即：修改.value值时会更新视图。而修改具体属性值时，不会更新视图。</strong></p>
<p>triggerRef  强制更新页面DOM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1、shallowRef() 函数是浅层响应，只有对value整体修改，才能更新到视图层。</span><br><span class="line">2、对属性值的修改是可以的，只是不更新到视图层。</span><br><span class="line">3、对属性值修改之后，我们可以通过triggerRef()函数手动更新到视图。</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 定义shallowRef变量</span><br><span class="line">const state &#x3D; shallowRef(&#123; count: 1 &#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 整体修改值（即.value），其template内的视图也会更新！</span><br><span class="line">state.value &#x3D; &#123; count: 2 &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 修改属性值时，其template内的视图不会更新！但并不代表其值没有被修改，仅仅是视图没更新</span><br><span class="line">state.value.count &#x3D; 2</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 此时我们可以用triggerRef函数手动更新视图</span><br><span class="line">triggerRef(state)</span><br></pre></td></tr></table></figure>

<h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a>customRef</h3><p>创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。</p>
<p>customRef 是个工厂函数要求我们自定义的 <code>ref</code> 中返回一个 <code>customRef</code>，而 <code>customRef</code> 也要返回一个对象，并且实现 get 和 set ，适合去做防抖之类的</p>
<p> customRef的两个参数分别是用于追踪的 track 与用于触发响应的 trigger</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;div ref&#x3D;&quot;div&quot;&gt;小满Ref&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;&#123; name &#125;&#125;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;change&quot;&gt;修改 customRef&lt;&#x2F;button&gt;</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; ref, reactive, onMounted, shallowRef, customRef &#125; from &#39;vue&#39;</span><br><span class="line"> </span><br><span class="line">function myRef&lt;T &#x3D; any&gt;(value: T) &#123;</span><br><span class="line">  let timer:any;</span><br><span class="line">  return customRef((track, trigger) &#x3D;&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      get() &#123;</span><br><span class="line">        track()</span><br><span class="line">        return value</span><br><span class="line">      &#125;,</span><br><span class="line">      set(newVal) &#123;</span><br><span class="line">        clearTimeout(timer)</span><br><span class="line">        timer &#x3D;  setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">          console.log(&#39;触发了set&#39;)</span><br><span class="line">          value &#x3D; newVal</span><br><span class="line">          trigger()</span><br><span class="line">        &#125;,500)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">const name &#x3D; myRef&lt;string&gt;(&#39;小满&#39;)</span><br><span class="line"> </span><br><span class="line">const change &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">  name.value &#x3D; &#39;大满&#39;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Reactive全家桶"><a href="#Reactive全家桶" class="headerlink" title="Reactive全家桶"></a>Reactive全家桶</h2><h3 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a><code>reactive</code></h3><p><strong>reactive 源码约束了我们的类型，用来绑定复杂的数据类型 例如 对象 数组</strong></p>
<p>使用reactive 去修改值无须.value</p>
<p>reactive 基础用法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">let person &#x3D; reactive(&#123;</span><br><span class="line">   name:&quot;小满&quot;</span><br><span class="line">&#125;)</span><br><span class="line">person.name &#x3D; &quot;大满&quot;</span><br></pre></td></tr></table></figure>

<p>数组异步赋值问题</p>
<p>这样赋值页面是不会变化的因为会脱离响应式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let person &#x3D; reactive&lt;number[]&gt;([])</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">  person &#x3D; [1, 2, 3]</span><br><span class="line">  console.log(person);</span><br><span class="line">  </span><br><span class="line">&#125;,1000)</span><br></pre></td></tr></table></figure>

<p>解决方案1  使用push</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">let person &#x3D; reactive&lt;number[]&gt;([])</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">  const arr &#x3D; [1, 2, 3]</span><br><span class="line">  person.push(...arr)</span><br><span class="line">  console.log(person);</span><br><span class="line">  </span><br><span class="line">&#125;,1000)</span><br></pre></td></tr></table></figure>

<p>方案2  包裹一层对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type Person &#x3D; &#123;</span><br><span class="line">  list?:Array&lt;number&gt;</span><br><span class="line">&#125;</span><br><span class="line">let person &#x3D; reactive&lt;Person&gt;(&#123;</span><br><span class="line">   list:[]</span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">  const arr &#x3D; [1, 2, 3]</span><br><span class="line">  person.list &#x3D; arr;</span><br><span class="line">  console.log(person);</span><br><span class="line">&#125;,1000)</span><br></pre></td></tr></table></figure>

<h3 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h3><p>取得一个对象（反应性或普通）或ref并返回一个只读代理。访问的任何嵌套属性也将是只读的。<br>传入普通对象等返回只读代理。<br>传入普通数值或字符串不能变成只读，例如 readonly(‘abc’)</p>
<p>可结合Provide/inject 使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const original &#x3D; reactive(&#123; count: 0 &#125;)</span><br><span class="line"></span><br><span class="line">const copy &#x3D; readonly(original)</span><br><span class="line"></span><br><span class="line">watchEffect(() &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F; 反应性跟踪</span><br><span class="line">  console.log(copy.count)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 改变 original 会触发观察copy的watcher执行其函数回调</span><br><span class="line">original.count++</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 改变 copy 将会失败并且在控制台返回一个警告</span><br><span class="line">copy.count++ &#x2F;&#x2F; warning!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a>shallowReactive</h3><p>只能对浅层的数据（对象第一层） 如果是深层的数据只会改变值 不会改变视图</p>
<h2 id="to系列全家桶"><a href="#to系列全家桶" class="headerlink" title="to系列全家桶"></a>to系列全家桶</h2><h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a>toRef</h3><ul>
<li>toRef是将对象中的某个值转化为响应式数据 toRef(obj,key)</li>
<li>注意点：就是 toRef 修改的值，只能修改原始对象为 响应式对象，toRe如果原始对象是非响应式的就不会更新视图 数据是会变的</li>
</ul>
<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h3><p>可以帮我们批量创建ref对象主要是方便我们解构使用</p>
<p>对对象解构时，解构出来的值为非响应式数据，但使用 toRefs 定义后 这些被解构出来的值 为响应式数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; reactive, toRefs &#125; from &#39;vue&#39;</span><br><span class="line">const obj &#x3D; reactive(&#123;</span><br><span class="line">   foo: 1,</span><br><span class="line">   bar: 1</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">let &#123; foo, bar &#125; &#x3D; toRefs(obj)</span><br><span class="line"> </span><br><span class="line">foo.value++</span><br><span class="line">console.log(foo, bar);</span><br></pre></td></tr></table></figure>

<h3 id="toRaw"><a href="#toRaw" class="headerlink" title="toRaw"></a>toRaw</h3><p>将响应式对象转化为普通对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; reactive, toRaw &#125; from &#39;vue&#39;</span><br><span class="line">const obj &#x3D; reactive(&#123;</span><br><span class="line">   foo: 1,</span><br><span class="line">   bar: 1</span><br><span class="line">&#125;)</span><br><span class="line">const state &#x3D; toRaw(obj)</span><br><span class="line">&#x2F;&#x2F; 响应式对象转化为普通对象</span><br><span class="line">const change &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">   console.log(obj, state);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="computed用法"><a href="#computed用法" class="headerlink" title="computed用法"></a>computed用法</h2><p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7&spm=1001.2101.3001.7020">计算属性</a>就是当依赖的属性的值发生变化的时候，才会触发他的更改，如果依赖的值，不发生变化的时候，使用的是缓存中的属性值。</p>
<p>1 函数形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let price &#x3D; ref(0)&#x2F;&#x2F;$0 </span><br><span class="line">let m &#x3D; computed&lt;string&gt;(()&#x3D;&gt;&#123;</span><br><span class="line">   return &#96;$&#96; + price.value</span><br><span class="line">&#125;)</span><br><span class="line">price.value &#x3D; 500</span><br></pre></td></tr></table></figure>

<p>2 对象形式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">let price &#x3D; ref&lt;number | string&gt;(1)&#x2F;&#x2F;$0</span><br><span class="line">let mul &#x3D; computed(&#123;</span><br><span class="line">   get: () &#x3D;&gt; &#123;</span><br><span class="line">      return price.value</span><br><span class="line">   &#125;,</span><br><span class="line">   set: (value) &#x3D;&gt; &#123;</span><br><span class="line">      price.value &#x3D; &#39;set&#39; + value</span><br><span class="line">   &#125;</span><br><span class="line">&#125;)</span><br><span class="line">const changeMul &#x3D; ()&#x3D;&gt; &#123;</span><br><span class="line">    mul.value &#x3D; &#39;***&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="watch侦听器"><a href="#watch侦听器" class="headerlink" title="watch侦听器"></a>watch侦听器</h2><p><code>watch</code> 需要侦听特定的数据源，并在单独的回调函数中执行副作用</p>
<p>watch第一个参数监听源</p>
<p>watch第二个参数回调函数cb（newVal,oldVal）</p>
<p>watch第三个参数一个options配置项是一个对象{</p>
<p>​    <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=immediate&spm=1001.2101.3001.7020">immediate</a>:true //是否立即调用一次</p>
<p>​    deep:true //是否开启<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%B7%B1%E5%BA%A6%E7%9B%91%E5%90%AC&spm=1001.2101.3001.7020">深度监听</a></p>
<p>}</p>
<p>监听Ref</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">let message &#x3D; ref(&#123;</span><br><span class="line">    nav:&#123;</span><br><span class="line">        bar:&#123;</span><br><span class="line">            name:&quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">watch(message, (newVal, oldVal) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;新的值----&#39;, newVal);</span><br><span class="line">    console.log(&#39;旧的值----&#39;, oldVal);</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    immediate:true,</span><br><span class="line">    deep:true</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>监听多个ref 注意变成数组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let message &#x3D; ref(&#39;&#39;)</span><br><span class="line">let message2 &#x3D; ref(&#39;&#39;)</span><br><span class="line"> </span><br><span class="line">watch([message,message2], (newVal, oldVal) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;新的值----&#39;, newVal);</span><br><span class="line">    console.log(&#39;旧的值----&#39;, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>监听Reactive</p>
<p>使用reactive监听深层对象开启和不开启deep 效果一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ref, watch ,reactive&#125; from &#39;vue&#39;</span><br><span class="line"> </span><br><span class="line">let message &#x3D; reactive(&#123;</span><br><span class="line">    nav:&#123;</span><br><span class="line">        bar:&#123;</span><br><span class="line">            name:&quot;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">watch(message, (newVal, oldVal) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;新的值----&#39;, newVal);</span><br><span class="line">    console.log(&#39;旧的值----&#39;, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>监听reactive 单一值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">let message &#x3D; reactive(&#123;</span><br><span class="line">    name:&quot;&quot;,</span><br><span class="line">    name2:&quot;&quot;</span><br><span class="line">&#125;)</span><br><span class="line">watch(()&#x3D;&gt;message.name, (newVal, oldVal) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;新的值----&#39;, newVal);</span><br><span class="line">    console.log(&#39;旧的值----&#39;, oldVal);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="watchEffect高级侦听器"><a href="#watchEffect高级侦听器" class="headerlink" title="watchEffect高级侦听器"></a>watchEffect高级侦听器</h2><p>立即执行传入的一个函数，同时<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%93%8D%E5%BA%94%E5%BC%8F&spm=1001.2101.3001.7020">响应式</a>追踪其依赖，并在其依赖变更时重新运行该函数。</p>
<p>watchEffect 接收2个参数 ，并且有返回一个 StopHandle 函数用来停止侦听。<br>1、第一个参数：（必传）<br>effect 函数，收集依赖，并且组件初始化时立即执行一次;<br>并且 effect 函数可以接受一个 onInvalidate 函数参数，该参数执行并传入一个 callback ，每次监听回调执行前都会执行该 callback。<br>2、第二个参数对象（非必传）： flush 、 onTrack 、 onTrigger; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">let count &#x3D; ref(0)</span><br><span class="line">let Cc &#x3D; computed(()&#x3D;&gt; count.value * 2)</span><br><span class="line">let obj &#x3D; reactive(&#123;</span><br><span class="line">  data:123,</span><br><span class="line">  inObj:&#123;d1:0&#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">const stop &#x3D; watchEffect((onInvalidate) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F;! 立即执行传入的回调函数，同时响应式追踪其所有依赖，并在依赖变更时重新运行该回调函数。</span><br><span class="line">  console.log(Cc.value); &#x2F;&#x2F; 注意，如果依赖是 ref 和 computed 对象，必须要.value，否则并不会视为依赖</span><br><span class="line">  console.log(count.value);</span><br><span class="line">  console.log(obj.data); &#x2F;&#x2F; 同理，reactive数据也只会侦听触发了get的property(属性)</span><br><span class="line">  &#x2F;&#x2F;! 注意首次执行并不会执行onInvalidate ，第二次开始才会！</span><br><span class="line">  onInvalidate(()&#x3D;&gt;&#123;</span><br><span class="line">    &#x2F;&#x2F;! 在回调触发前会调用该函数，并且stop()停止侦听的时候也会触发一次！</span><br><span class="line">    console.log(&#39;watchEffect的onInvalidate&#39;);</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line">&#125;,&#123;</span><br><span class="line">  flush:&#39;pre&#39;, &#x2F;&#x2F; flush?: &#39;pre&#39; | &#39;post&#39; | &#39;sync&#39; &#x2F;&#x2F; 默认：&#39;pre&#39;</span><br><span class="line">  </span><br><span class="line">  &#x2F;&#x2F;! 跟踪之前会触发该函数，收集了多少个依赖就触发多少次！返回对应依赖信息</span><br><span class="line">  onTrack(e)&#123;console.log(e.target,&#39;onTrack触发&#39;)&#125;, </span><br><span class="line"> </span><br><span class="line">  &#x2F;&#x2F;! 跟他名字一样依赖更改就触发执行，而且是同步的！没有所谓的缓冲回调</span><br><span class="line">  onTrigger(e)&#123;console.log(e.target,&#39;onTrigger触发&#39;)&#125; </span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(() &#x3D;&gt; &#123;</span><br><span class="line">  stop() &#x2F;&#x2F; 停止侦听 则调用该返回值即可 </span><br><span class="line">&#125;, 1000*5);</span><br></pre></td></tr></table></figure>

<h3 id="清除副作用-oninvalidate"><a href="#清除副作用-oninvalidate" class="headerlink" title="清除副作用 oninvalidate"></a>清除副作用 oninvalidate</h3><p>在触发监听之前会调用一个函数可以处理你的逻辑例如<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%98%B2%E6%8A%96&spm=1001.2101.3001.7020">防抖</a></p>
<ol>
<li>在回调触发前会调用该函数</li>
<li>侦听器被停止 (如果在 <code>setup()</code> 或生命周期钩子函数中使用了 <code>watchEffect</code>，在组件卸载时会自动停止侦听。)</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let message &#x3D; ref&lt;string&gt;(&#39;&#39;)</span><br><span class="line">let message2 &#x3D; ref&lt;string&gt;(&#39;&#39;)</span><br><span class="line"> watchEffect((oninvalidate) &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F;console.log(&#39;message&#39;, message.value);</span><br><span class="line">    oninvalidate(()&#x3D;&gt;&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">    console.log(&#39;message2&#39;, message2.value);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="副作用刷新时机-flush-一般使用post"><a href="#副作用刷新时机-flush-一般使用post" class="headerlink" title="副作用刷新时机 flush 一般使用post"></a>副作用刷新时机 flush 一般使用post</h3><table>
<thead>
<tr>
<th align="left"></th>
<th align="left">pre</th>
<th align="left">sync</th>
<th align="left">post</th>
</tr>
</thead>
<tbody><tr>
<td align="left">更新时机</td>
<td align="left">组件<strong>更新前</strong>执行</td>
<td align="left">强制效果始终同步触发</td>
<td align="left">组件<strong>更新后</strong>执行</td>
</tr>
</tbody></table>
<p><strong>停止跟踪</strong></p>
<p>watchEffect 返回一个函数 调用之后将停止更新</p>
<p>生命周期钩子函数中使用了 <code>watchEffect</code>，在组件卸载时也会自动停止侦听。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const stop &#x3D;  watchEffect((oninvalidate) &#x3D;&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F;console.log(&#39;message&#39;, message.value);</span><br><span class="line">    oninvalidate(()&#x3D;&gt;&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;)</span><br><span class="line">    console.log(&#39;message2&#39;, message2.value);</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    flush:&quot;post&quot;,</span><br><span class="line">    onTrigger () &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#x2F;&#x2F; 停止跟踪</span><br><span class="line">stop()</span><br></pre></td></tr></table></figure>



<h2 id="组件的生命周期"><a href="#组件的生命周期" class="headerlink" title="组件的生命周期"></a>组件的生命周期</h2><table>
<thead>
<tr>
<th align="left">选项式 API</th>
<th align="left">Hook inside <code>setup</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>beforeCreate</code></td>
<td align="left">Not needed*</td>
</tr>
<tr>
<td align="left"><code>created</code></td>
<td align="left">Not needed*</td>
</tr>
<tr>
<td align="left"><code>beforeMount</code></td>
<td align="left"><code>onBeforeMount</code></td>
</tr>
<tr>
<td align="left"><code>mounted</code></td>
<td align="left"><code>onMounted</code></td>
</tr>
<tr>
<td align="left"><code>beforeUpdate</code></td>
<td align="left"><code>onBeforeUpdate</code></td>
</tr>
<tr>
<td align="left"><code>updated</code></td>
<td align="left"><code>onUpdated</code></td>
</tr>
<tr>
<td align="left"><code>beforeUnmount</code></td>
<td align="left"><code>onBeforeUnmount</code></td>
</tr>
<tr>
<td align="left"><code>unmounted</code></td>
<td align="left"><code>onUnmounted</code></td>
</tr>
<tr>
<td align="left"><code>errorCaptured</code></td>
<td align="left"><code>onErrorCaptured</code></td>
</tr>
<tr>
<td align="left"><code>renderTracked</code></td>
<td align="left"><code>onRenderTracked</code></td>
</tr>
<tr>
<td align="left"><code>renderTriggered</code></td>
<td align="left"><code>onRenderTriggered</code></td>
</tr>
<tr>
<td align="left"><code>activated</code></td>
<td align="left"><code>onActivated</code></td>
</tr>
<tr>
<td align="left"><code>deactivated</code></td>
<td align="left"><code>onDeactivated</code></td>
</tr>
</tbody></table>
<p>1  <code>onRenderTracked</code> 直译过来就是状态跟踪，他会跟踪页面上所有的方法跟变量，也就是我们<code>return</code>返回的属性与方法，它都会进行跟踪。当页面有<code>update</code>时，会生成一个<code>event</code>对象。我们可以通过这个<code>event</code>对象查看程序的问题所在。</p>
<p>2  <code>onRenderTriggered</code>直译过来是状态触发，它不会跟踪每一个值，而是给你变化值的信息，并且新值和旧值都会给你明确的展示出来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">新值newValue和旧值oldValue都会给你明确的展示出来。主要的属性介绍</span><br><span class="line">key 哪个变量发生了变化</span><br><span class="line">newValue 更新后变量的值</span><br><span class="line">oldValue 更新前变量的值</span><br><span class="line">target 目前页面中的响应变量和函数</span><br></pre></td></tr></table></figure>

<p><strong>activated,deactivated</strong></p>
<p>activated,deactivated这两个生命周期函数一定是要在使用了keep-alive组件后才会有的，否则则不存在当引入keep-alive的时候，页面第一次进入，钩子的触发顺序created-&gt; mounted-&gt; activated，退出时触发deactivated。当再次进入（前进或者后退）时，只触发activated。<br>组件每次进去执行的方法放在 activated 中， activated 中的不管是否需要缓存多会执行。</p>
<h2 id="VNode-hooks"><a href="#VNode-hooks" class="headerlink" title="VNode hooks"></a>VNode hooks</h2><p>在每个组件或HTML标签上，我们可以使用一些特殊的（文档没写的）钩子作为事件监听器。这些钩子有：</p>
<ul>
<li><p>onVnodeBeforeMount</p>
</li>
<li><p>onVnodeMounted</p>
</li>
<li><p>onVnodeBeforeUpdate</p>
</li>
<li><p>onVnodeUpdated</p>
</li>
<li><p>onVnodeBeforeUnmount</p>
</li>
<li><p>onVnodeUnmounted</p>
<p>在组件上使用<code>onVnodeMounted</code>，当需要在组件挂载时执行一些代码，或者在更新时使用<code>onVnodeUpdated</code>进行调试，可以确定的是所有这些钩子都能在某些情况下派上用场。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;</span><br><span class="line"></span><br><span class="line">const count &#x3D; ref(0)</span><br><span class="line"></span><br><span class="line">function onMyComponentMounted() &#123;&#125;</span><br><span class="line"></span><br><span class="line">function divThatDisplaysCountWasUpdated() &#123;&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;MyComponent @vnodeMounted&#x3D;&quot;onMyComponentMounted&quot; &#x2F;&gt;</span><br><span class="line">  &lt;div @vnodeUpdated&#x3D;&quot;divThatDisplaysCountWasUpdated&quot;&gt;&#123;&#123; count &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，这些钩子向回调函数传递一些参数。除了<code>onVnodeBeforeUpdate</code>和<code>onVnodeUpdated</code>传递两个参数，即当前的<code>VNode</code>和之前的<code>VNode</code>，其它只传递一个参数，即当前的<code>VNode</code></p>
</li>
</ul>
<h2 id="父子组件传参"><a href="#父子组件传参" class="headerlink" title="父子组件传参"></a>父子组件传参</h2><h3 id="defineProps"><a href="#defineProps" class="headerlink" title="defineProps "></a><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=defineProps&spm=1001.2101.3001.7020">defineProps </a></h3><p>子组件接受值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">父组件</span><br><span class="line">&lt;Menu :data&#x3D;&quot;data&quot;  title&#x3D;&quot;我是标题&quot;&gt;&lt;&#x2F;Menu&gt;</span><br><span class="line">子组件 ts可以使用传递字面量类型的纯类型语法做为参数</span><br><span class="line">defineProps&lt;&#123;</span><br><span class="line">    title:string,</span><br><span class="line">    data:number[]</span><br><span class="line">&#125;&gt;()</span><br><span class="line">&#x2F;&#x2F; withDefaults是个函数也是无须引入开箱即用接受一个props函数第二个参数是一个对象设置默认值</span><br><span class="line">type Props &#x3D; &#123;</span><br><span class="line">    title?: string,</span><br><span class="line">    data?: number[]</span><br><span class="line">&#125;</span><br><span class="line">withDefaults(defineProps&lt;Props&gt;(), &#123;</span><br><span class="line">    title: &quot;张三&quot;,</span><br><span class="line">    data: () &#x3D;&gt; [1, 2, 3]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">不是TS</span><br><span class="line">defineProps(&#123;</span><br><span class="line">    title:&#123;</span><br><span class="line">        default:&quot;&quot;,</span><br><span class="line">        type:string</span><br><span class="line">    &#125;,</span><br><span class="line">    data:Array</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="defineEmits"><a href="#defineEmits" class="headerlink" title="defineEmits"></a>defineEmits</h3><p>子组件给父组件传参 通过defineEmits派发一个事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;menu&quot;&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;clickTap&quot;&gt;派发给父组件&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; reactive &#125; from &#39;vue&#39;</span><br><span class="line">const list &#x3D; reactive&lt;number[]&gt;([4, 5, 6])</span><br><span class="line"> </span><br><span class="line">const emit &#x3D; defineEmits([&#39;on-click&#39;])</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F;如果用了ts可以这样</span><br><span class="line">&#x2F;&#x2F; const emit &#x3D; defineEmits&lt;&#123;</span><br><span class="line">&#x2F;&#x2F;     (e: &quot;on-click&quot;, name: string): void</span><br><span class="line">&#x2F;&#x2F; &#125;&gt;()</span><br><span class="line">const clickTap &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    emit(&#39;on-click&#39;, list)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="defineExpose"><a href="#defineExpose" class="headerlink" title="defineExpose"></a>defineExpose</h3><p>子组件暴露给父组件内部属性   从父组件获取子组件实例通过ref </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> &lt;Menu ref&#x3D;&quot;menus&quot;&gt;&lt;&#x2F;Menu&gt;</span><br><span class="line">&#x2F;&#x2F;这样获取是有代码提示的</span><br><span class="line"> const menus &#x3D; ref&lt;InstanceType&lt;typeof menus&gt;&gt;()</span><br></pre></td></tr></table></figure>

<p>然后打印menus.value 发现没有任何属性</p>
<p>这时候父组件想要读到子组件的属性可以通过 defineExpose暴露    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const list &#x3D; reactive&lt;number[]&gt;([4, 5, 6])</span><br><span class="line"> </span><br><span class="line">defineExpose(&#123;</span><br><span class="line">    list</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="依赖注入Provide-Inject"><a href="#依赖注入Provide-Inject" class="headerlink" title="依赖注入Provide / Inject"></a>依赖注入Provide / Inject</h2><p>provide 可以在祖先组件中指定我们想要<strong>提供</strong>给后代组件的数据或方法，而在任何后代组件中，我们都可以使用 inject 来接收 provide <strong>提供</strong>的数据或方法。 </p>
<p>父组件传递数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;App&quot;&gt;</span><br><span class="line">        &lt;button&gt;我是App&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;A&gt;&lt;&#x2F;A&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">    </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; provide, ref &#125; from &#39;vue&#39;</span><br><span class="line">import A from &#39;.&#x2F;components&#x2F;A.vue&#39;</span><br><span class="line">let flag &#x3D; ref&lt;number&gt;(1)</span><br><span class="line">provide(&#39;flag&#39;, flag)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;style&gt;</span><br><span class="line">.App &#123;</span><br><span class="line">    background: blue;</span><br><span class="line">    color: #fff;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>子组件接受</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;background-color: green;&quot;&gt;</span><br><span class="line">        我是B</span><br><span class="line">        &lt;button @click&#x3D;&quot;change&quot;&gt;change falg&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;div&gt;&#123;&#123; flag &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">    </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; inject, Ref, ref &#125; from &#39;vue&#39;</span><br><span class="line"> </span><br><span class="line">const flag &#x3D; inject&lt;Ref&lt;number&gt;&gt;(&#39;flag&#39;, ref(1))</span><br><span class="line"> </span><br><span class="line">const change &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    flag.value &#x3D; 2</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>如果传递普通的值 是不具有响应式的 需要通过ref reactive 添加响应式</p>
<p>使用场景</p>
<p>当父组件有很多数据需要分发给其子代组件的时候， 就可以使用provide和inject。</p>
<h2 id="兄弟组件传参和Bus"><a href="#兄弟组件传参和Bus" class="headerlink" title="兄弟组件传参和Bus"></a>兄弟组件传参和Bus</h2><h3 id="借助父组件传参"><a href="#借助父组件传参" class="headerlink" title="借助父组件传参"></a>借助父组件传参</h3><p>A 组件派发事件通过App.vue 接受A组件派发的事件然后在Props 传给B组件 也是可以实现的</p>
<p>缺点就是比较麻烦 ，无法直接通信，只能充当桥梁</p>
<h3 id="Event-Bus"><a href="#Event-Bus" class="headerlink" title="Event Bus"></a>Event Bus</h3><p>可以使用$emit 传递 $on监听 emit传递过来的事件</p>
<p>简易版</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">type BusClass&lt;T&gt; &#x3D; &#123;</span><br><span class="line">    emit: (name: T) &#x3D;&gt; void</span><br><span class="line">    on: (name: T, callback: Function) &#x3D;&gt; void</span><br><span class="line">&#125;</span><br><span class="line">type BusParams &#x3D; string | number | symbol </span><br><span class="line">type List &#x3D; &#123;</span><br><span class="line">    [key: BusParams]: Array&lt;Function&gt;</span><br><span class="line">&#125;</span><br><span class="line">class Bus&lt;T extends BusParams&gt; implements BusClass&lt;T&gt; &#123;</span><br><span class="line">    list: List</span><br><span class="line">    constructor() &#123;</span><br><span class="line">        this.list &#x3D; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    emit(name: T, ...args: Array&lt;any&gt;) &#123;</span><br><span class="line">        let eventName: Array&lt;Function&gt; &#x3D; this.list[name]</span><br><span class="line">        eventName.forEach(ev &#x3D;&gt; &#123;</span><br><span class="line">            ev.apply(this, args)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    on(name: T, callback: Function) &#123;</span><br><span class="line">        let fn: Array&lt;Function&gt; &#x3D; this.list[name] || [];</span><br><span class="line">        fn.push(callback)</span><br><span class="line">        this.list[name] &#x3D; fn</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">export default new Bus&lt;number&gt;()</span><br></pre></td></tr></table></figure>

<p>然后挂载到Vue config 全局就可以使用</p>
<h2 id="全局组件，局部组件，递归组件"><a href="#全局组件，局部组件，递归组件" class="headerlink" title="全局组件，局部组件，递归组件"></a>全局组件，局部组件，递归组件</h2><h3 id="配置全局组件"><a href="#配置全局组件" class="headerlink" title="配置全局组件"></a>配置全局组件</h3><p>在main.ts 引入我们的组件跟随在createApp(App) 后面 切记不能放到mount 后面这是一个链式调用用</p>
<p>调用 component 第一个参数组件名称 第二个参数组件实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createApp &#125; from &#39;vue&#39;</span><br><span class="line">import App from &#39;.&#x2F;App.vue&#39;</span><br><span class="line">import &#39;.&#x2F;assets&#x2F;css&#x2F;reset&#x2F;index.less&#39;</span><br><span class="line">import Card from &#39;.&#x2F;components&#x2F;Card&#x2F;index.vue&#39;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">createApp(App).component(&#39;Card&#39;,Card).mount(&#39;#app&#39;)</span><br></pre></td></tr></table></figure>

<p>直接在其他vue页面 立即使用即可 无需引入</p>
<h3 id="批量注册全局组件"><a href="#批量注册全局组件" class="headerlink" title="批量注册全局组件"></a>批量注册全局组件</h3><p>element ui :遍历一下然后通过 app.component 注册</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import * as ElementPlusIconVue from &#39;@element-plus&#x2F;icons-vue&#39;</span><br><span class="line">const app &#x3D; created(App)</span><br><span class="line">for(const [key,component] of Object.entries(ElementPlusIconVue))&#123;</span><br><span class="line">	app.component(key,component)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="配置局部组件"><a href="#配置局部组件" class="headerlink" title="配置局部组件"></a>配置局部组件</h3><p>就是在一个组件内（A） 通过import 去引入别的组件(B) 称之为局部组件</p>
<p>应为B组件只能在A组件内使用 所以是局部组件</p>
<p>如果C组件想用B组件 就需要C组件也手动import 引入 B 组件</p>
<h3 id="配置递归组件"><a href="#配置递归组件" class="headerlink" title="配置递归组件"></a>配置递归组件</h3><p>子组件增加一个组件名称(为了 递归用 )</p>
<p>组件定义名称几种方式</p>
<p>1.再增加一个script 通过 export 添加name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name:&quot;TreeItem&quot;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>2.直接使用文件名当组件名</p>
<p>3.使用插件 unplugin-vue-define-options   </p>
<p>​     ts支持 <code>&quot;types&quot;: [&quot;unplugin-vue-define-options/macros-global&quot;]</code></p>
<h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><p>什么是动态组件 就是：让多个组件使用同一个挂载点，并动态切换，这就是动态组件</p>
<p>在挂载点使用<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=component&spm=1001.2101.3001.7020">component</a>标签，然后使用<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=v-bind&spm=1001.2101.3001.7020">v-bind</a>:is=”组件”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  &lt;component :is&#x3D;&quot;A&quot;&gt;&lt;&#x2F;component&gt;</span><br><span class="line"></span><br><span class="line">import A from &#39;.&#x2F;A.vue&#39;</span><br><span class="line">import B from &#39;.&#x2F;B.vue&#39;</span><br></pre></td></tr></table></figure>

<p>通过is 切换 A B 组件</p>
<p><strong><em>\</em>注意事项**</strong> </p>
<p><strong><em>\</em>1.在Vue2 的时候is 是通过组件名称切换的 在Vue3 setup 是通过组件实例切换的**</strong></p>
<p><strong><em>\</em>2.如果你把组件实例放到Reactive Vue会给你一个警告runtime-core.esm-bundler.js:38 [Vue warn]: Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with <code>markRaw</code> or using <code>shallowRef</code> instead of <code>ref</code>.<br>Component that was made reactive:**</strong> </p>
<p><strong><em>\</em>这是因为reactive 会进行proxy 代理 而我们组件代理之后毫无用处 节省性能开销 推荐我们使用shallowRef 或者 markRaw 跳过proxy 代理**</strong></p>
<p><strong><em>\</em>修改如下**</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const tab &#x3D; reactive&lt;Com[]&gt;([&#123;</span><br><span class="line">    name: &quot;A组件&quot;,</span><br><span class="line">    comName: markRaw(A)</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    name: &quot;B组件&quot;,</span><br><span class="line">    comName: markRaw(B)</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure>

<h2 id="插槽slot"><a href="#插槽slot" class="headerlink" title="插槽slot"></a>插槽slot</h2><p>插槽就是子组件中的提供给父组件使用的一个<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8D%A0%E4%BD%8D%E7%AC%A6&spm=1001.2101.3001.7020">占位符</a>，用<slot></slot> 表示，父组件可以在这个占位符中填充任何模板代码，如 HTML、组件等，填充的内容会替换子组件的<slot></slot>标签。</p>
<h3 id="匿名插槽"><a href="#匿名插槽" class="headerlink" title="匿名插槽"></a>匿名插槽</h3><p>1.在子组件放置一个插槽</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">       &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>父组件使用插槽</p>
<p>在父组件给这个插槽填充内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">   &lt;template v-slot&gt;</span><br><span class="line">       &lt;div&gt;2132&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">&lt;&#x2F;Dialog&gt;</span><br></pre></td></tr></table></figure>

<h3 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%85%B7%E5%90%8D%E6%8F%92%E6%A7%BD&spm=1001.2101.3001.7020">具名插槽</a></h3><p>具名插槽其实就是给插槽取个名字。一个子组件可以放多个插槽，而且可以放在不同的地方，而父组件填充内容时，可以根据这个名字把内容填充到对应插槽中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot name&#x3D;&quot;header&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;slot name&#x3D;&quot;footer&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<p>父组件使用需对应名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template v-slot:header&gt;</span><br><span class="line">       &lt;div&gt;1&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">   &lt;template v-slot&gt;</span><br><span class="line">       &lt;div&gt;2&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">   &lt;template v-slot:footer&gt;</span><br><span class="line">       &lt;div&gt;3&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">&lt;&#x2F;Dialog&gt;</span><br></pre></td></tr></table></figure>

<p> 插槽简写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template #header&gt;</span><br><span class="line">       &lt;div&gt;1&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">   &lt;template #default&gt;</span><br><span class="line">       &lt;div&gt;2&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">   &lt;template #footer&gt;</span><br><span class="line">       &lt;div&gt;3&lt;&#x2F;div&gt;</span><br><span class="line">   &lt;&#x2F;template&gt;</span><br><span class="line">&lt;&#x2F;Dialog&gt;</span><br></pre></td></tr></table></figure>

<h3 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h3><p>在子组件<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%8A%A8%E6%80%81%E7%BB%91%E5%AE%9A&spm=1001.2101.3001.7020">动态绑定</a>参数 派发给父组件的slot去使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot name&#x3D;&quot;header&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;div v-for&#x3D;&quot;item in 100&quot;&gt;</span><br><span class="line">            &lt;slot :data&#x3D;&quot;item&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;slot name&#x3D;&quot;footer&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>

<p>通过结构方式取值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;Dialog&gt;</span><br><span class="line">    &lt;template #header&gt;</span><br><span class="line">        &lt;div&gt;1&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">    &lt;template #default&#x3D;&quot;&#123; data &#125;&quot;&gt;</span><br><span class="line">        &lt;div&gt;&#123;&#123; data &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">        &lt;div&gt;3&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">&lt;&#x2F;Dialog&gt;</span><br></pre></td></tr></table></figure>

<h3 id="动态插槽"><a href="#动态插槽" class="headerlink" title="动态插槽"></a>动态插槽</h3><p>插槽可以是一个变量名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template #[name]&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            23</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;template&gt;</span><br><span class="line">&lt;&#x2F;Dialog&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const name &#x3D; ref(&#39;header&#39;)</span><br></pre></td></tr></table></figure>

<h3 id="从子组件暴露插槽"><a href="#从子组件暴露插槽" class="headerlink" title="从子组件暴露插槽"></a>从子组件暴露插槽</h3><p>有时，我们使用第三方组件时，会把它的实现包装在我们自定义组件中。这是一个很好的做法和可扩展的解决方案，但这样一来，第三方组件的插槽就会丢失，下面方法可以将它们的插槽暴露在父组件中：</p>
<p><strong>WrapperComponent.vue</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class&#x3D;&quot;wrapper-of-third-party-component&quot;&gt;</span><br><span class="line">    &lt;ThirdPartyComponent v-bind&#x3D;&quot;$attrs&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 暴露第三方组件的插槽  --&gt;</span><br><span class="line">        &lt;template v-for&#x3D;&quot;(_, name) in $slots&quot; #[name]&#x3D;&quot;slotData&quot;&gt;</span><br><span class="line">            &lt;slot :name&#x3D;&quot;name&quot; v-bind&#x3D;&quot;slotData || &#123;&#125;&quot;&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">        &lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;ThirdPartyComponent&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<p>现在每个使用<code>WrapperComponent</code>的组件都可以使用第三方组件的插槽。</p>
<h2 id="异步组件-amp-代码分包-amp-suspense"><a href="#异步组件-amp-代码分包-amp-suspense" class="headerlink" title="异步组件&amp;代码分包&amp;suspense"></a>异步组件&amp;代码分包&amp;suspense</h2><h3 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h3><p>在大型应用中，我们可能需要将应用分割成小一些的代码块 并且减少主包的体积</p>
<p>这时候就可以使用异步组件</p>
<p><strong>顶层 <code>await</code></strong></p>
<p>在setup语法糖里面 使用方法</p>
<p><code>&lt;script setup&gt; 中可以使用顶层 await。结果代码会被编译成 async setup()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const post &#x3D; await fetch(&#96;&#x2F;api&#x2F;post&#x2F;1&#96;).then(r &#x3D;&gt; r.json())</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>父组件引用子组件 通过defineAsyncComponent加载异步配合import 函数模式便可以分包</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; reactive, ref, markRaw, toRaw, defineAsyncComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="javascript"><span class="keyword">const</span> Dialog = defineAsyncComponent(<span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;../../components/Dialog/index.vue&#x27;</span>))</span></span><br><span class="line"> </span><br><span class="line"><span class="javascript"><span class="comment">//完整写法</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> AsyncComp = defineAsyncComponent(&#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 加载函数</span></span></span><br><span class="line"><span class="javascript">  loader: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;./Foo.vue&#x27;</span>),</span></span><br><span class="line"> </span><br><span class="line"><span class="javascript">  <span class="comment">// 加载异步组件时使用的组件</span></span></span><br><span class="line">  loadingComponent: LoadingComponent,</span><br><span class="line"><span class="javascript">  <span class="comment">// 展示加载组件前的延迟时间，默认为 200ms</span></span></span><br><span class="line">  delay: 200,</span><br><span class="line"> </span><br><span class="line"><span class="javascript">  <span class="comment">// 加载失败后展示的组件</span></span></span><br><span class="line">  errorComponent: ErrorComponent,</span><br><span class="line"><span class="javascript">  <span class="comment">// 如果提供了一个 timeout 时间限制，并超时了</span></span></span><br><span class="line"><span class="javascript">  <span class="comment">// 也会显示这里配置的报错组件，默认值是：Infinity</span></span></span><br><span class="line">  timeout: 3000</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="suspense"><a href="#suspense" class="headerlink" title="suspense"></a>suspense</h3><p><code>&lt;suspense&gt;</code> 组件有两个插槽。它们都只接收一个直接子节点。<code>default</code> 插槽里的节点会尽可能展示出来。如果不能，则展示 <code>fallback</code> 插槽里的节点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;Suspense&gt;</span><br><span class="line">       &lt;template #default&gt;</span><br><span class="line">           &lt;Dialog&gt;</span><br><span class="line">               &lt;template #default&gt;</span><br><span class="line">                   &lt;div&gt;我在哪儿&lt;&#x2F;div&gt;</span><br><span class="line">               &lt;&#x2F;template&gt;</span><br><span class="line">           &lt;&#x2F;Dialog&gt;</span><br><span class="line">       &lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">       &lt;template #fallback&gt;</span><br><span class="line">           &lt;div&gt;loading...&lt;&#x2F;div&gt;</span><br><span class="line">       &lt;&#x2F;template&gt;</span><br><span class="line">   &lt;&#x2F;Suspense&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Teleport传送组件"><a href="#Teleport传送组件" class="headerlink" title="Teleport传送组件"></a>Teleport传送组件</h2><p>Teleport 是一种能够将我们的模板渲染至指定DOM节点，不受父级style、v-show等属性影响，但data、prop数据依旧能够共用的技术；</p>
<p>主要解决的问题 因为Teleport节点挂载在其他指定的DOM节点下，完全不受父级style样式影响</p>
<p>使用方法</p>
<p>通过to 属性 插入指定元素位置 to=”body” 便可以将<code>Teleport</code> 内容传送到指定位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Teleport to&#x3D;&quot;body&quot;&gt;</span><br><span class="line">    &lt;Loading&gt;&lt;&#x2F;Loading&gt;</span><br><span class="line">&lt;&#x2F;Teleport&gt;</span><br></pre></td></tr></table></figure>

<p>也可以自定义传送位置 支持 class id等 选择器</p>
<p>多个使用场景</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Teleport to&#x3D;&quot;.modal1&quot;&gt;</span><br><span class="line">     &lt;Loading&gt;&lt;&#x2F;Loading&gt;</span><br><span class="line">&lt;&#x2F;Teleport&gt;</span><br><span class="line">&lt;Teleport to&#x3D;&quot;.modal2&quot;&gt;</span><br><span class="line">     &lt;Loading&gt;&lt;&#x2F;Loading&gt;</span><br><span class="line">&lt;&#x2F;Teleport&gt;</span><br></pre></td></tr></table></figure>

<p>动态控制teleport</p>
<p>使用disabled 设置为 true则 to属性不生效 false 则生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;teleport :disabled&#x3D;&quot;true&quot; to&#x3D;&#39;body&#39;&gt;</span><br><span class="line">  &lt;A&gt;&lt;&#x2F;A&gt;</span><br><span class="line">&lt;&#x2F;teleport&gt;</span><br></pre></td></tr></table></figure>

<h2 id="keep-alive缓存组件"><a href="#keep-alive缓存组件" class="headerlink" title="keep-alive缓存组件"></a>keep-alive缓存组件</h2><p>有时候我们不希望组件被重新渲染影响使用体验；或者处于性能考虑，避免多次重复渲染降低性能。而是希望组件可以缓存下来,维持当前的状态。这时候就需要用到<code>keep-alive</code>组件。</p>
<p>开启keep-alive 生命周期的变化</p>
<p>初次进入时： onMounted&gt; onActivated<br>退出后触发 deactivated<br>再次进入：<br>只会触发 onActivated<br>事件挂载的方法等，只执行一次的放在 onMounted中；组件每次进去执行的方法放在 onActivated中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 基本 --&gt;</span><br><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;component :is&#x3D;&quot;view&quot;&gt;&lt;&#x2F;component&gt;</span><br><span class="line">&lt;&#x2F;keep-alive&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!-- 多个条件判断的子组件 --&gt;</span><br><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;comp-a v-if&#x3D;&quot;a &gt; 1&quot;&gt;&lt;&#x2F;comp-a&gt;</span><br><span class="line">  &lt;comp-b v-else&gt;&lt;&#x2F;comp-b&gt;</span><br><span class="line">&lt;&#x2F;keep-alive&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!-- 和 &#96;&lt;transition&gt;&#96; 一起使用 --&gt;</span><br><span class="line">&lt;transition&gt;</span><br><span class="line">  &lt;keep-alive&gt;</span><br><span class="line">    &lt;component :is&#x3D;&quot;view&quot;&gt;&lt;&#x2F;component&gt;</span><br><span class="line">  &lt;&#x2F;keep-alive&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<p><strong><code>include</code> 和 <code>exclude</code></strong></p>
<p> <code>&lt;keep-alive :include=&quot;&quot; :exclude=&quot;&quot; :max=&quot;&quot;&gt;&lt;/keep-alive&gt;</code></p>
<p>include 和 exclude 允许组件有条件地缓存。二者都可以用逗号分隔字符串、正则表达式或一个数组来表示：</p>
<p><strong><code>max</code></strong></p>
<p><code>&lt;keep-alive :max=&quot;10&quot;&gt;   &lt;component :is=&quot;view&quot;&gt;&lt;/component&gt; &lt;/keep-alive&gt;</code></p>
<h2 id="transition动画组件"><a href="#transition动画组件" class="headerlink" title="transition动画组件"></a>transition动画组件</h2><p> Vue 提供了 transition 的封装组件，在下列情形中，可以给任何元素和组件添加进入/离开过渡:</p>
<ul>
<li>条件渲染 (使用 v-if)</li>
<li>条件展示 (使用 v-show)</li>
<li>动态组件</li>
<li>组件根节点</li>
</ul>
<p>自定义 transition 过度效果，你需要对<code>transition</code>组件的<code>name</code>属性自定义。并在css中写入对应的样式</p>
<h3 id="过渡的类名"><a href="#过渡的类名" class="headerlink" title="过渡的类名"></a>过渡的类名</h3><p>在进入/离开的过渡中，会有 6 个 class 切换。</p>
<p>过渡 class   在进入/离开的过渡中，会有 6 个 class 切换。</p>
<p>v-enter-from：定义进入过渡的开始状态。在元素被插入之前生效，在元素被插入之后的下一帧移除。</p>
<p>v-enter-active：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</p>
<p>v-enter-to：定义进入过渡的结束状态。在元素被插入之后下一帧生效 (与此同时 v-enter-from 被移除)，在过渡/动画完成之后移除。</p>
<p>v-leave-from：定义离开过渡的开始状态。在离开过渡被触发时立刻生效，下一帧被移除。</p>
<p>v-leave-active：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</p>
<p>v-leave-to：离开过渡的结束状态。在离开过渡被触发之后下一帧生效 (与此同时 v-leave-from 被移除)，在过渡/动画完成之后移除。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;button @click&#x3D;&#39;flag &#x3D; !flag&#39;&gt;切换&lt;&#x2F;button&gt;</span><br><span class="line">&lt;transition name&#x3D;&#39;fade&#39;&gt;</span><br><span class="line">	&lt;div v-if&#x3D;&#39;flag&#39; class&#x3D;&quot;box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;开始过度</span><br><span class="line">.fade-enter-from&#123;</span><br><span class="line">   background:red;</span><br><span class="line">   width:0px;</span><br><span class="line">   height:0px;</span><br><span class="line">   transform:rotate(360deg)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;开始过度了</span><br><span class="line">.fade-enter-active&#123;</span><br><span class="line">  transition: all 2.5s linear;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;过度完成</span><br><span class="line">.fade-enter-to&#123;</span><br><span class="line">   background:yellow;</span><br><span class="line">   width:200px;</span><br><span class="line">   height:200px;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;离开的过度</span><br><span class="line">.fade-leave-from&#123;</span><br><span class="line">  width:200px;</span><br><span class="line">  height:200px;</span><br><span class="line">  transform:rotate(360deg)</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;离开中过度</span><br><span class="line">.fade-leave-active&#123;</span><br><span class="line">  transition: all 1s linear;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;离开完成</span><br><span class="line">.fade-leave-to&#123;</span><br><span class="line">  width:0px;</span><br><span class="line">   height:0px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义过渡-class-类名"><a href="#自定义过渡-class-类名" class="headerlink" title="自定义过渡 class 类名"></a>自定义过渡 class 类名</h3><p>transition props</p>
<ul>
<li><code>enter-from-class</code></li>
<li><code>enter-active-class</code></li>
<li><code>enter-to-class</code></li>
<li><code>leave-from-class</code></li>
<li><code>leave-active-class</code></li>
<li><code>leave-to-class</code></li>
</ul>
<p>自定义过度时间 单位毫秒</p>
<p>你也可以分别指定进入和离开的持续时间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition :duration&#x3D;&quot;1000&quot;&gt;...&lt;&#x2F;transition&gt;</span><br><span class="line"> </span><br><span class="line">&lt;transition :duration&#x3D;&quot;&#123; enter: 500, leave: 800 &#125;&quot;&gt;...&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<p>自定义class</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition</span><br><span class="line">    leave-active-class&#x3D;&quot;animate__animated animate__bounceInLeft&quot;</span><br><span class="line">    enter-active-class&#x3D;&quot;animate__animated animate__bounceInRight&quot;</span><br><span class="line">&gt;</span><br><span class="line">    &lt;div v-if&#x3D;&quot;flag&quot; class&#x3D;&quot;box&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition&gt;</span><br></pre></td></tr></table></figure>

<h3 id="transition-生命周期8个"><a href="#transition-生命周期8个" class="headerlink" title="transition 生命周期8个"></a>transition 生命周期8个</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@before-enter&#x3D;&quot;beforeEnter&quot; &#x2F;&#x2F;对应enter-from</span><br><span class="line">@enter&#x3D;&quot;enter&quot;&#x2F;&#x2F;对应enter-active</span><br><span class="line">@after-enter&#x3D;&quot;afterEnter&quot;&#x2F;&#x2F;对应enter-to</span><br><span class="line">@enter-cancelled&#x3D;&quot;enterCancelled&quot;&#x2F;&#x2F;显示过度打断</span><br><span class="line">@before-leave&#x3D;&quot;beforeLeave&quot;&#x2F;&#x2F;对应leave-from</span><br><span class="line">@leave&#x3D;&quot;leave&quot;&#x2F;&#x2F;对应enter-active</span><br><span class="line">@after-leave&#x3D;&quot;afterLeave&quot;&#x2F;&#x2F;对应leave-to</span><br><span class="line">@leave-cancelled&#x3D;&quot;leaveCancelled&quot;&#x2F;&#x2F;离开过度打断</span><br></pre></td></tr></table></figure>

<p>当只用 JavaScript 过渡的时候，在 <strong><code>enter</code> 和 <code>leave</code> 钩子中必须使用 <code>done</code> 进行回调</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const beforeEnter &#x3D; (el: Element) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;进入之前from&#39;, el);</span><br><span class="line">&#125;</span><br><span class="line">const Enter &#x3D; (el: Element,done:Function) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;过度曲线&#39;);</span><br><span class="line">    setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">       done()</span><br><span class="line">    &#125;,3000)</span><br><span class="line">&#125;</span><br><span class="line">const AfterEnter &#x3D; (el: Element) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(&#39;to&#39;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="appear"><a href="#appear" class="headerlink" title="appear"></a>appear</h3><p>通过这个属性可以设置初始节点过度 就是页面加载完成就开始动画 对应三个状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">appear-active-class&#x3D;&quot;&quot;</span><br><span class="line">appear-from-class&#x3D;&quot;&quot;</span><br><span class="line">appear-to-class&#x3D;&quot;&quot;</span><br><span class="line">appear</span><br></pre></td></tr></table></figure>

<h2 id="transition-group过度列表"><a href="#transition-group过度列表" class="headerlink" title="transition-group过度列表"></a>transition-group过度列表</h2><p>怎么同时渲染整个列表，比如使用 <code>v-for</code>？在这种场景下，我们会使用 <code>&lt;transition-group&gt;</code> 组件。</p>
<ul>
<li>默认情况下，它不会渲染一个包裹元素，但是你可以通过 <code>tag</code> attribute 指定渲染一个元素。</li>
<li><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/transitions-enterleave.html#%E8%BF%87%E6%B8%A1%E6%A8%A1%E5%BC%8F">过渡模式</a>不可用，因为我们不再相互切换特有的元素。</li>
<li>内部元素<strong>总是需要</strong>提供唯一的 <code>key</code> attribute 值。</li>
<li>CSS 过渡的类将会应用在内部的元素中，而不是这个组/容器本身。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;transition-group&gt;</span><br><span class="line">     &lt;div style&#x3D;&quot;margin: 10px;&quot; :key&#x3D;&quot;item&quot; v-for&#x3D;&quot;item in list&quot;&gt;&#123;&#123; item &#125;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;transition-group&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const list &#x3D; reactive&lt;number[]&gt;([1, 2, 4, 5, 6, 7, 8, 9])</span><br><span class="line">const Push &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    list.push(123)</span><br><span class="line">&#125;</span><br><span class="line">const Pop &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    list.pop()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="列表的移动过渡"><a href="#列表的移动过渡" class="headerlink" title="列表的移动过渡"></a>列表的移动过渡</h3><p><code>&lt;transition-group&gt;</code> 组件还有一个特殊之处。除了进入和离开，它还可以为定位的改变添加动画。只需了解新增的 v-move 类就可以使用这个新功能，它会应用在元素改变定位的过程中。像之前的类名一样，它的前缀可以通过 name attribute 来自定义，也可以通过 move-class attribute 手动设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;shuffle&quot;&gt;Shuffle&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;transition-group class&#x3D;&quot;wraps&quot; name&#x3D;&quot;mmm&quot; tag&#x3D;&quot;ul&quot;&gt;</span><br><span class="line">            &lt;li class&#x3D;&quot;cell&quot; v-for&#x3D;&quot;item in items&quot; :key&#x3D;&quot;item.id&quot;&gt;&#123;&#123; item.number &#125;&#125;&lt;&#x2F;li&gt;</span><br><span class="line">        &lt;&#x2F;transition-group&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">  </span><br><span class="line">&lt;script setup  lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import _ from &#39;lodash&#39;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;</span><br><span class="line">let items &#x3D; ref(Array.apply(null, &#123; length: 81 &#125; as number[]).map((_, index) &#x3D;&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        id: index,</span><br><span class="line">        number: (index % 9) + 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;))</span><br><span class="line">const shuffle &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    items.value &#x3D; _.shuffle(items.value)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">  </span><br><span class="line">&lt;style scoped lang&#x3D;&quot;less&quot;&gt;</span><br><span class="line">.wraps &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-wrap: wrap;</span><br><span class="line">    width: calc(25px * 10 + 9px);</span><br><span class="line">    .cell &#123;</span><br><span class="line">        width: 25px;</span><br><span class="line">        height: 25px;</span><br><span class="line">        border: 1px solid #ccc;</span><br><span class="line">        list-style-type: none;</span><br><span class="line">        display: flex;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        align-items: center;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">.mmm-move &#123;</span><br><span class="line">    transition: transform 0.8s ease;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="状态过渡"><a href="#状态过渡" class="headerlink" title="状态过渡"></a>状态过渡</h3><p>Vue 也同样可以给字体 背景颜色等添加过渡动画</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;input step&#x3D;&quot;20&quot; v-model&#x3D;&quot;num.current&quot; type&#x3D;&quot;number&quot; &#x2F;&gt;</span><br><span class="line">        &lt;div&gt;&#123;&#123; num.tweenedNumber.toFixed(0) &#125;&#125;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">    </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; reactive, watch &#125; from &#39;vue&#39;</span><br><span class="line">import gsap from &#39;gsap&#39;</span><br><span class="line">const num &#x3D; reactive(&#123;</span><br><span class="line">    tweenedNumber: 0,</span><br><span class="line">    current:0</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">watch(()&#x3D;&gt;num.current, (newVal) &#x3D;&gt; &#123;</span><br><span class="line">    gsap.to(num, &#123;</span><br><span class="line">        duration: 1,</span><br><span class="line">        tweenedNumber: newVal</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">    </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="深入v-model"><a href="#深入v-model" class="headerlink" title="深入v-model"></a>深入v-model</h2><p>v-model 其实是一个语法糖 通过props 和 emit组合而成的</p>
<p>1.默认值的改变</p>
<ul>
<li>prop：<code>value</code> -&gt; <code>modelValue</code>；</li>
<li>事件：<code>input</code> -&gt; <code>update:modelValue</code>；</li>
<li><code>v-bind</code> 的 <code>.sync</code> 修饰符和组件的 <code>model</code> 选项已移除</li>
<li>新增 支持多个v-model</li>
<li>新增 支持自定义 修饰符 Modifiers</li>
</ul>
<p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;show &#x3D; !show&quot;&gt;开关&#123;&#123;show&#125;&#125;&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;Dialog v-model&#x3D;&quot;show&quot;&gt;&lt;&#x2F;Dialog&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import Dialog from &quot;.&#x2F;components&#x2F;Dialog&#x2F;index.vue&quot;;</span><br><span class="line">import &#123;ref&#125; from &#39;vue&#39;</span><br><span class="line">const show &#x3D; ref(false)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">     &lt;div v-if&#x3D;&#39;propData.modelValue&#39; class&#x3D;&quot;dialog&quot;&gt;</span><br><span class="line">         &lt;div class&#x3D;&quot;dialog-header&quot;&gt;</span><br><span class="line">             &lt;div&gt;标题&lt;&#x2F;div&gt;&lt;div @click&#x3D;&quot;close&quot;&gt;x&lt;&#x2F;div&gt;</span><br><span class="line">         &lt;&#x2F;div&gt;</span><br><span class="line">         &lt;div class&#x3D;&quot;dialog-content&quot;&gt;</span><br><span class="line">            内容</span><br><span class="line">         &lt;&#x2F;div&gt;</span><br><span class="line">     &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line"> </span><br><span class="line">type Props &#x3D; &#123;</span><br><span class="line">   modelValue:boolean</span><br><span class="line">&#125;</span><br><span class="line">const propData &#x3D; defineProps&lt;Props&gt;()</span><br><span class="line">const emit &#x3D; defineEmits([&#39;update:modelValue&#39;])</span><br><span class="line">const close &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">     emit(&#39;update:modelValue&#39;,false)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;style lang&#x3D;&#39;less&#39;&gt;</span><br><span class="line">.dialog&#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    position: fixed;</span><br><span class="line">    left:50%;</span><br><span class="line">    top:50%;</span><br><span class="line">    transform: translate(-50%,-50%);</span><br><span class="line">    &amp;-header&#123;</span><br><span class="line">        border-bottom: 1px solid #ccc;</span><br><span class="line">        display: flex;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">        padding: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;-content&#123;</span><br><span class="line">        padding: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="绑定多个案例"><a href="#绑定多个案例" class="headerlink" title="绑定多个案例"></a>绑定多个案例</h3><p>父组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;show &#x3D; !show&quot;&gt;开关&#123;&#123;show&#125;&#125; ----- &#123;&#123;title&#125;&#125;&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;Dialog v-model:title&#x3D;&#39;title&#39; v-model&#x3D;&quot;show&quot;&gt;&lt;&#x2F;Dialog&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import Dialog from &quot;.&#x2F;components&#x2F;Dialog&#x2F;index.vue&quot;;</span><br><span class="line">import &#123;ref&#125; from &#39;vue&#39;</span><br><span class="line">const show &#x3D; ref(false)</span><br><span class="line">const title &#x3D; ref(&#39;我是标题&#39;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>子组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">     &lt;div v-if&#x3D;&#39;modelValue &#39; class&#x3D;&quot;dialog&quot;&gt;</span><br><span class="line">         &lt;div class&#x3D;&quot;dialog-header&quot;&gt;</span><br><span class="line">             &lt;div&gt;标题---&#123;&#123;title&#125;&#125;&lt;&#x2F;div&gt;&lt;div @click&#x3D;&quot;close&quot;&gt;x&lt;&#x2F;div&gt;</span><br><span class="line">         &lt;&#x2F;div&gt;</span><br><span class="line">         &lt;div class&#x3D;&quot;dialog-content&quot;&gt;</span><br><span class="line">            内容</span><br><span class="line">         &lt;&#x2F;div&gt;</span><br><span class="line">         </span><br><span class="line">     &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line"> </span><br><span class="line">type Props &#x3D; &#123;</span><br><span class="line">   modelValue:boolean,</span><br><span class="line">   title:string</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">const propData &#x3D; defineProps&lt;Props&gt;()</span><br><span class="line"> </span><br><span class="line">const emit &#x3D; defineEmits([&#39;update:modelValue&#39;,&#39;update:title&#39;])</span><br><span class="line"> </span><br><span class="line">const close &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">     emit(&#39;update:modelValue&#39;,false)</span><br><span class="line">     emit(&#39;update:title&#39;,&#39;我要改变&#39;)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style lang&#x3D;&#39;less&#39;&gt;</span><br><span class="line">.dialog&#123;</span><br><span class="line">    width: 300px;</span><br><span class="line">    height: 300px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    position: fixed;</span><br><span class="line">    left:50%;</span><br><span class="line">    top:50%;</span><br><span class="line">    transform: translate(-50%,-50%);</span><br><span class="line">    &amp;-header&#123;</span><br><span class="line">        border-bottom: 1px solid #ccc;</span><br><span class="line">        display: flex;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">        padding: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">    &amp;-content&#123;</span><br><span class="line">        padding: 10px;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="自定义修饰符"><a href="#自定义修饰符" class="headerlink" title="自定义修饰符"></a>自定义修饰符</h3><p>添加到组件 <code>v-model</code> 的修饰符将通过 <code>modelModifiers</code> prop 提供给组件。在下面的示例中，我们创建了一个组件，其中包含默认为空对象的 <code>modelModifiers</code> prop</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line"> </span><br><span class="line">type Props &#x3D; &#123;</span><br><span class="line">    modelValue: boolean,</span><br><span class="line">    title?: string,</span><br><span class="line">    modelModifiers?: &#123;</span><br><span class="line">        default: () &#x3D;&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    titleModifiers?: &#123;</span><br><span class="line">        default: () &#x3D;&gt; &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">const propData &#x3D; defineProps&lt;Props&gt;()</span><br><span class="line"> </span><br><span class="line">const emit &#x3D; defineEmits([&#39;update:modelValue&#39;, &#39;update:title&#39;])</span><br><span class="line"> </span><br><span class="line">const close &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    console.log(propData.modelModifiers);</span><br><span class="line"> </span><br><span class="line">    emit(&#39;update:modelValue&#39;, false)</span><br><span class="line">    emit(&#39;update:title&#39;, &#39;我要改变&#39;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自定义指令directive-属于破坏性更新"><a href="#自定义指令directive-属于破坏性更新" class="headerlink" title="自定义指令directive(属于破坏性更新)"></a>自定义指令directive(属于破坏性更新)</h2><p>directive-<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4&spm=1001.2101.3001.7020">自定义指令</a>（属于破坏性更新）</p>
<h3 id="vue3指令的钩子函数"><a href="#vue3指令的钩子函数" class="headerlink" title="vue3指令的钩子函数"></a>vue3指令的钩子函数</h3><p>created 元素初始化的时候<br>beforeMount 指令绑定到元素后调用 只调用一次<br>mounted 元素插入父级dom调用<br>beforeUpdate 元素被更新之前调用<br>update 这个周期方法被移除 改用updated<br>beforeUnmount 在元素被移除前调用<br>unmounted 指令被移除后调用 只调用一次</p>
<p>Vue2 指令 bind inserted update componentUpdated unbind</p>
<h3 id="在setup内定义局部指令"><a href="#在setup内定义局部指令" class="headerlink" title="在setup内定义局部指令"></a>在setup内定义局部指令</h3><p>这里有一个需要注意的限制：必须以 <code>vNameOfDirective</code> 的形式来命名本地自定义指令，以使得它们可以直接在模板中使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click&#x3D;&quot;show &#x3D; !show&quot;&gt;开关&#123;&#123;show&#125;&#125; ----- &#123;&#123;title&#125;&#125;&lt;&#x2F;button&gt;</span><br><span class="line">  &lt;Dialog  v-move-directive&#x3D;&quot;&#123;background:&#39;green&#39;,flag:show&#125;&quot;&gt;&lt;&#x2F;Dialog&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">const</span> vMoveDirective: Directive = &#123;</span><br><span class="line">  created: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;初始化====&gt;&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeMount</span>(<span class="params">...args: <span class="built_in">Array</span>&lt;any&gt;</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 在元素上做些操作</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;初始化一次=======&gt;&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params">el: any, dir: DirectiveBinding&lt;Value&gt;</span>)</span> &#123;</span><br><span class="line">    el.style.background = dir.value.background;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;初始化========&gt;&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeUpdate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;更新之前&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">updated</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;更新结束&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">beforeUnmount</span>(<span class="params">...args: <span class="built_in">Array</span>&lt;any&gt;</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(args);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;======&gt;卸载之前&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">unmounted</span>(<span class="params">...args: <span class="built_in">Array</span>&lt;any&gt;</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(args);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;======&gt;卸载完成&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="生命周期钩子参数详解"><a href="#生命周期钩子参数详解" class="headerlink" title="生命周期钩子参数详解"></a>生命周期钩子参数详解</h3><p>第一个 el 当前绑定的DOM 元素</p>
<p>第二个 binding</p>
<p>instance：使用指令的组件实例。<br>value：传递给指令的值。例如，在 v-my-directive=”1 + 1” 中，该值为 2。<br>oldValue：先前的值，仅在 beforeUpdate 和 updated 中可用。无论值是否有更改都可用。<br>arg：传递给指令的参数(如果有的话)。例如在 v-my-directive:foo 中，arg 为 “foo”。<br>modifiers：包含修饰符(如果有的话) 的对象。例如在 v-my-directive.foo.bar 中，修饰符对象为 {foo: true，bar: true}。<br>dir：一个对象，在注册指令时作为参数传递。</p>
<p>第三个 当前元素的虚拟DOM 也就是Vnode</p>
<p>第四个 prevNode 上一个虚拟节点，仅在 <code>beforeUpdate</code> 和 <code>updated</code> 钩子中可用 </p>
<h3 id="函数简写"><a href="#函数简写" class="headerlink" title="函数简写"></a>函数简写</h3><p>你可能想在 <code>mounted</code> 和 <code>updated</code> 时触发相同行为，而不关心其他的钩子函数。那么你可以通过将这个函数模式实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;input v-model&#x3D;&quot;value&quot; type&#x3D;&quot;text&quot; &#x2F;&gt;</span><br><span class="line">      &lt;A v-move&#x3D;&quot;&#123; background: value &#125;&quot;&gt;&lt;&#x2F;A&gt;</span><br><span class="line">   &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">   </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import A from &#39;.&#x2F;components&#x2F;A.vue&#39;</span><br><span class="line">import &#123; ref, Directive, DirectiveBinding &#125; from &#39;vue&#39;</span><br><span class="line">let value &#x3D; ref&lt;string&gt;(&#39;&#39;)</span><br><span class="line">type Dir &#x3D; &#123;</span><br><span class="line">   background: string</span><br><span class="line">&#125;</span><br><span class="line">const vMove: Directive &#x3D; (el, binding: DirectiveBinding&lt;Dir&gt;) &#x3D;&gt; &#123;</span><br><span class="line">   el.style.background &#x3D; binding.value.background</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>自定义拖拽指令 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-move class&#x3D;&quot;box&quot;&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;header&quot;&gt;&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      内容</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; Directive &#125; from &quot;vue&quot;;</span><br><span class="line">const vMove: Directive &#x3D; &#123;</span><br><span class="line">  mounted(el: HTMLElement) &#123;</span><br><span class="line">    let moveEl &#x3D; el.firstElementChild as HTMLElement;</span><br><span class="line">    const mouseDown &#x3D; (e: MouseEvent) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F;鼠标点击物体那一刻相对于物体左侧边框的距离&#x3D;点击时的位置相对于浏览器最左边的距离-物体左边框相对于浏览器最左边的距离</span><br><span class="line">      console.log(e.clientX, e.clientY, &quot;-----起始&quot;, el.offsetLeft);</span><br><span class="line">      let X &#x3D; e.clientX - el.offsetLeft;</span><br><span class="line">      let Y &#x3D; e.clientY - el.offsetTop;</span><br><span class="line">      const move &#x3D; (e: MouseEvent) &#x3D;&gt; &#123;</span><br><span class="line">        el.style.left &#x3D; e.clientX - X + &quot;px&quot;;</span><br><span class="line">        el.style.top &#x3D; e.clientY - Y + &quot;px&quot;;</span><br><span class="line">        console.log(e.clientX, e.clientY, &quot;---改变&quot;);</span><br><span class="line">      &#125;;</span><br><span class="line">      document.addEventListener(&quot;mousemove&quot;, move);</span><br><span class="line">      document.addEventListener(&quot;mouseup&quot;, () &#x3D;&gt; &#123;</span><br><span class="line">        document.removeEventListener(&quot;mousemove&quot;, move);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">    moveEl.addEventListener(&quot;mousedown&quot;, mouseDown);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style lang&#x3D;&#39;less&#39;&gt;</span><br><span class="line">.box &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  left: 50%;</span><br><span class="line">  top: 50%;</span><br><span class="line">  transform: translate(-50%, -50%);</span><br><span class="line">  width: 200px;</span><br><span class="line">  height: 200px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  .header &#123;</span><br><span class="line">    height: 20px;</span><br><span class="line">    background: black;</span><br><span class="line">    cursor: move;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="自定义Hooks"><a href="#自定义Hooks" class="headerlink" title="自定义Hooks"></a>自定义Hooks</h2><p>Vue3 自定义Hook</p>
<p>主要用来处理复用代码逻辑的一些封装</p>
<p>这个在vue2 就已经有一个东西是Mixins</p>
<p>mixins就是将这些多个相同的逻辑抽离出来，各个组件只需要引入mixins，就能实现一次写代码，多组件受益的效果。</p>
<p>弊端就是 会涉及到覆盖的问题</p>
<p>组件的data、methods、filters会覆盖mixins里的同名data、methods、filters。</p>
<p>第二点就是 变量来源不明确（隐式传入），不利于阅读，使代码变得难以维护。</p>
<p>Vue3 的自定义的hook</p>
<p>Vue3 的 hook函数 相当于 vue2 的 mixin, 不同在与 hooks 是函数<br>Vue3 的 hook函数 可以帮助我们提高代码的复用性, 让我们能在不同的组件中都利用 hooks 函数</p>
<p>Vue3 hook 库<a target="_blank" rel="noopener" href="https://vueuse.org/guide/">Get Started | VueUse</a></p>
<h2 id="Vue3定义全局函数和变量"><a href="#Vue3定义全局函数和变量" class="headerlink" title="Vue3定义全局函数和变量"></a>Vue3定义全局函数和变量</h2><h3 id="globalProperties"><a href="#globalProperties" class="headerlink" title="globalProperties"></a>globalProperties</h3><p>由于<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Vue3&spm=1001.2101.3001.7020">Vue3</a> 没有Prototype 属性 使用 app.config.globalProperties 代替 然后去定义变量和函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 之前 (Vue 2.x)</span></span><br><span class="line">Vue.prototype.$http = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 之后 (Vue 3.x)</span></span><br><span class="line"><span class="keyword">const</span> app = createApp(&#123;&#125;)</span><br><span class="line">app.config.globalProperties.$http = <span class="function">() =&gt;</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><p>在Vue3 移除了</p>
<p>可以使用全局函数代替Filters</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.config.globalProperties.$filters = &#123;</span><br><span class="line">  format&lt;T <span class="keyword">extends</span> any&gt;(str: T): string &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`$<span class="subst">$&#123;str&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>声明文件 不然TS无法正确类型 推导</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type Filter = &#123;</span><br><span class="line">    format&lt;T&gt;(str: T): string</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 声明要扩充@vue/runtime-core包的声明.</span></span><br><span class="line"><span class="comment">// 这里扩充&quot;ComponentCustomProperties&quot;接口, 因为他是vue3中实例的属性的类型.</span></span><br><span class="line">declare <span class="built_in">module</span> <span class="string">&#x27;vue&#x27;</span> &#123;</span><br><span class="line">    <span class="keyword">export</span> interface ComponentCustomProperties &#123;</span><br><span class="line">        $filters: Filter</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>setup 读取值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getCurrentInstance, ComponentInternalInstance &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> &#123; appContext &#125; = &lt;ComponentInternalInstance&gt;getCurrentInstance()</span><br><span class="line"> </span><br><span class="line"><span class="built_in">console</span>.log(appContext.config.globalProperties.$env);</span><br><span class="line"> </span><br><span class="line">推荐第二种方式</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> &#123;ref,reactive,getCurrentInstance&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = getCurrentInstance()</span><br><span class="line"><span class="built_in">console</span>.log(app?.proxy?.$filters.format(<span class="string">&#x27;js&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="编写Vue3插件"><a href="#编写Vue3插件" class="headerlink" title="编写Vue3插件"></a>编写Vue3插件</h2><p>插件是自包含的代码，通常向 Vue 添加全局级功能。你如果是一个对象需要有install方法Vue会帮你自动注入到install 方法 你如果是function 就直接当install 方法去使用</p>
<p>在使用 <code>createApp()</code> 初始化 Vue 应用程序后，你可以通过调用 <code>use()</code> 方法将插件添加到你的应用程序中。</p>
<p>实现一个Loading</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Loading.Vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div v-if&#x3D;&quot;isShow&quot; class&#x3D;&quot;loading&quot;&gt;</span><br><span class="line">        &lt;div class&#x3D;&quot;loading-content&quot;&gt;Loading...&lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">    </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;;</span><br><span class="line">const isShow &#x3D; ref(false)&#x2F;&#x2F;定位loading 的开关</span><br><span class="line"> </span><br><span class="line">const show &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    isShow.value &#x3D; true</span><br><span class="line">&#125;</span><br><span class="line">const hide &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    isShow.value &#x3D; false</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;对外暴露 当前组件的属性和方法</span><br><span class="line">defineExpose(&#123;</span><br><span class="line">    isShow,</span><br><span class="line">    show,</span><br><span class="line">    hide</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;style scoped lang&#x3D;&quot;less&quot;&gt;</span><br><span class="line">.loading &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    inset: 0;</span><br><span class="line">    background: rgba(0, 0, 0, 0.8);</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    &amp;-content &#123;</span><br><span class="line">        font-size: 30px;</span><br><span class="line">        color: #fff;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Loading.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;  createVNode, render, VNode, App &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> Loading <span class="keyword">from</span> <span class="string">&#x27;./index.vue&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="function"><span class="title">install</span>(<span class="params">app: App</span>)</span> &#123;</span><br><span class="line">        <span class="comment">//createVNode vue提供的底层方法 可以给我们组件创建一个虚拟DOM 也就是Vnode</span></span><br><span class="line">        <span class="keyword">const</span> vnode: VNode = createVNode(Loading)</span><br><span class="line">        <span class="comment">//render 把我们的Vnode 生成真实DOM 并且挂载到指定节点</span></span><br><span class="line">        render(vnode, <span class="built_in">document</span>.body)</span><br><span class="line">        <span class="comment">// Vue 提供的全局配置 可以自定义</span></span><br><span class="line">        app.config.globalProperties.$loading = &#123;</span><br><span class="line">            show: <span class="function">() =&gt;</span> vnode.component?.exposed?.show(),</span><br><span class="line">            hide: <span class="function">() =&gt;</span> vnode.component?.exposed?.hide()</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Main.ts</span></span><br><span class="line"><span class="keyword">import</span> Loading <span class="keyword">from</span> <span class="string">&#x27;./components/loading&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> app = createApp(App)</span><br><span class="line">app.use(Loading)</span><br><span class="line">type Lod = &#123;</span><br><span class="line">    show: <span class="function">() =&gt;</span> <span class="keyword">void</span>,</span><br><span class="line">    hide: <span class="function">() =&gt;</span> <span class="keyword">void</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//编写ts loading 声明文件放置报错 和 智能提示</span></span><br><span class="line">declare <span class="built_in">module</span> <span class="string">&#x27;@vue/runtime-core&#x27;</span> &#123;</span><br><span class="line">    <span class="keyword">export</span> interface ComponentCustomProperties &#123;</span><br><span class="line">        $loading: Lod</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 使用方法</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; ref,reactive,getCurrentInstance&#125; from &#39;vue&#39;</span><br><span class="line">const  instance &#x3D; getCurrentInstance()  </span><br><span class="line">instance?.proxy?.$Loading.show()</span><br><span class="line">setTimeout(()&#x3D;&gt;&#123;</span><br><span class="line">  instance?.proxy?.$Loading.hide()</span><br><span class="line">&#125;,5000)</span><br><span class="line">&#x2F;&#x2F; console.log(instance)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">*&#123;</span><br><span class="line">  padding: 0;</span><br><span class="line">  margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Vue-use-源码手写"><a href="#Vue-use-源码手写" class="headerlink" title="Vue use 源码手写"></a>Vue use 源码手写</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import type &#123; App &#125; from &#39;vue&#39;</span><br><span class="line">import &#123; app &#125; from &#39;.&#x2F;main&#39;</span><br><span class="line"> </span><br><span class="line">interface Use &#123;</span><br><span class="line">    install: (app: App, ...options: any[]) &#x3D;&gt; void</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">const installedList &#x3D; new Set()</span><br><span class="line"> </span><br><span class="line">export function MyUse&lt;T extends Use&gt;(plugin: T, ...options: any[]) &#123;</span><br><span class="line">    if(installedList.has(plugin))&#123;</span><br><span class="line">      return console.warn(&#39;重复添加插件&#39;,plugin)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        plugin.install(app, ...options)</span><br><span class="line">        installedList.add(plugin)</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="Scoped和样式-穿透"><a href="#Scoped和样式-穿透" class="headerlink" title="Scoped和样式 穿透"></a>Scoped和样式 穿透</h2><p>主要是用于修改很多vue常用的组件库（element, <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=vant&spm=1001.2101.3001.7020">vant</a>, AntDesigin），虽然配好了样式但是还是需要更改其他的样式</p>
<p>就需要用到<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%A0%B7%E5%BC%8F%E7%A9%BF%E9%80%8F&spm=1001.2101.3001.7020">样式穿透</a></p>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=scoped&spm=1001.2101.3001.7020">scoped</a>的原理</p>
<p>vue中的scoped 通过在DOM结构以及css样式上加唯一不重复的标记:data-v-hash的方式，以保证唯一（而这个工作是由过PostCSS转译实现的），达到样式私有化模块化的目的。</p>
<p>总结一下scoped三条渲染规则：</p>
<ol>
<li>给HTML的DOM节点加一个不重复data属性(形如：data-v-123)来表示他的唯一性</li>
<li>在每句css选择器的末尾（编译后的生成的css语句）加一个当前组件的data属性选择器（如[data-v-123]）来私有化样式</li>
<li>如果组件内部包含有其他组件，只会给其他组件的最外层标签加上当前组件的data属性（具有多个根节点的子组件不能从父范围的样式设置样式）</li>
</ol>
<p>PostCSS会给一个组件中的所有dom添加了一个独一无二的动态属性data-v-xxxx，然后，给CSS选择器额外添加一个对应的属性选择器来选择该组件中dom，这种做法使得样式只作用于含有该属性的dom——组件内部dom, 从而达到了’样式模块化’的效果.</p>
<p> Vue 提供了样式穿透:<strong>deep()</strong> 他的作用就是用来改变 属性选择器的位置</p>
<h2 id="css-Style完整新特性"><a href="#css-Style完整新特性" class="headerlink" title="css Style完整新特性"></a>css Style完整新特性</h2><p>除了deep(),其实还有两个选择器可以补充</p>
<h3 id="插槽选择器-slotted"><a href="#插槽选择器-slotted" class="headerlink" title="插槽选择器(slotted)"></a>插槽选择器(slotted)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; A组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        我是插槽</span><br><span class="line">        &lt;slot&gt;&lt;&#x2F;slot&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"> :slotted(.a) &#123;</span><br><span class="line">    color:red</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;A&gt;</span><br><span class="line">            &lt;div class&#x3D;&quot;a&quot;&gt;私人定制div&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;&#x2F;A&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import A from &quot;@&#x2F;components&#x2F;A.vue&quot;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style lang&#x3D;&quot;less&quot; scoped&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>



<h3 id="全局选择器"><a href="#全局选择器" class="headerlink" title="全局选择器"></a>全局选择器</h3><p>在之前我们想加入全局 样式 通常都是新建一个style 标签 不加<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=scoped&spm=1001.2101.3001.7020">scoped</a> 现在有更优雅的解决方案</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line"> <span class="selector-tag">div</span>&#123;</span><br><span class="line">     <span class="attribute">color</span>:red</span><br><span class="line"> &#125;</span><br><span class="line">&lt;/<span class="selector-tag">style</span>&gt;</span><br><span class="line"> </span><br><span class="line">//  效果等同于上面</span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"><span class="selector-pseudo">:global(div)</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>:red</span><br><span class="line">&#125;</span><br><span class="line">&lt;/<span class="selector-tag">style</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="动态-CSS"><a href="#动态-CSS" class="headerlink" title="动态 CSS"></a>动态 CSS</h3><p>单文件组件的 <code>&lt;style&gt;</code> 标签可以通过 <code>v-bind</code> 这一 CSS 函数将 CSS 的值关联到动态的组件状态上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;div&quot;&gt;</span><br><span class="line">       小满是个弟弟</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script lang&#x3D;&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#39;vue&#39;</span><br><span class="line">const red &#x3D; ref&lt;string&gt;(&#39;red&#39;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style lang&#x3D;&quot;less&quot; scoped&gt;</span><br><span class="line">.div&#123;</span><br><span class="line">   color:v-bind(red)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<p>如果是对象 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=v-bind&spm=1001.2101.3001.7020">v-bind</a> ,加引号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> &lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;div&quot;&gt;</span><br><span class="line">        小满是个弟弟</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script lang&#x3D;&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;</span><br><span class="line">const red &#x3D; ref(&#123;</span><br><span class="line">    color:&#39;pink&#39;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;style lang&#x3D;&quot;less&quot; scoped&gt;</span><br><span class="line">.div &#123;</span><br><span class="line">    color: v-bind(&#39;red.color&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Mitt"><a href="#Mitt" class="headerlink" title="Mitt"></a>Mitt</h2><p>在<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=vue3&spm=1001.2101.3001.7020">vue3</a>中$on，$off 和 $once 实例方法已被移除，组件实例不再实现事件触发接口，因此大家熟悉的EventBus便无法使用了。然而我们习惯了使用EventBus，对于这种情况我们可以使用Mitt库（其实就是我们视频中讲的发布订阅模式的设计）</p>
<h3 id="main-ts-初始化"><a href="#main-ts-初始化" class="headerlink" title="main.ts 初始化"></a>main.ts 初始化</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> Mit = mitt()</span><br><span class="line"> </span><br><span class="line"><span class="comment">//TypeScript注册</span></span><br><span class="line"><span class="comment">// 由于必须要拓展ComponentCustomProperties类型才能获得类型提示</span></span><br><span class="line"><span class="keyword">declare</span> <span class="built_in">module</span> <span class="string">&quot;vue&quot;</span> &#123;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">interface</span> ComponentCustomProperties &#123;</span><br><span class="line">        $Bus: <span class="keyword">typeof</span> Mit</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> app = createApp(App)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//Vue3挂载全局API</span></span><br><span class="line">app.config.globalProperties.$Bus = Mit</span><br><span class="line"> </span><br><span class="line">app.mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="使用方法通过emit派发，-on-方法添加事件，off-方法移除，clear-清空所有"><a href="#使用方法通过emit派发，-on-方法添加事件，off-方法移除，clear-清空所有" class="headerlink" title="使用方法通过emit派发， on 方法添加事件，off 方法移除，clear 清空所有"></a>使用方法通过emit派发， on 方法添加事件，off 方法移除，clear 清空所有</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; A组件派发（emit）</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;我是A&lt;&#x2F;h1&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;emit1&quot;&gt;emit1&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;emit2&quot;&gt;emit2&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; getCurrentInstance &#125; from &#39;vue&#39;</span><br><span class="line">const instance &#x3D; getCurrentInstance();</span><br><span class="line">const emit1 &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    instance?.proxy?.$Bus.emit(&#39;on-num&#39;, 100)</span><br><span class="line">&#125;</span><br><span class="line">const emit2 &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">    instance?.proxy?.$Bus.emit(&#39;*****&#39;, 500)</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">B组件监听（on）</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;我是B&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang&#x3D;&#39;ts&#39;&gt;</span><br><span class="line">import &#123; getCurrentInstance &#125; from &#39;vue&#39;</span><br><span class="line">const instance &#x3D; getCurrentInstance()</span><br><span class="line">instance?.proxy?.$Bus.on(&#39;on-num&#39;, (num) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(num,&#39;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;B&#39;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="监听所有事件（-on-“-”-）"><a href="#监听所有事件（-on-“-”-）" class="headerlink" title="监听所有事件（ on(“*”) ）"></a>监听所有事件（ on(“*”) ）</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">instance?.proxy?.$Bus.on(<span class="string">&#x27;*&#x27;</span>,<span class="function">(<span class="params"><span class="keyword">type</span>,num</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">type</span>,num,<span class="string">&#x27;===========&gt;B&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="移除监听事件（off）"><a href="#移除监听事件（off）" class="headerlink" title="移除监听事件（off）"></a>移除监听事件（off）</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Fn = <span class="function">(<span class="params">num: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num, <span class="string">&#x27;===========&gt;B&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">instance?.proxy?.$Bus.on(<span class="string">&#x27;on-num&#x27;</span>,Fn)<span class="comment">//listen</span></span><br><span class="line">instance?.proxy?.$Bus.off(<span class="string">&#x27;on-num&#x27;</span>,Fn)<span class="comment">//unListen</span></span><br></pre></td></tr></table></figure>

<h3 id="清空所有监听（clear）"><a href="#清空所有监听（clear）" class="headerlink" title="清空所有监听（clear）"></a>清空所有监听（clear）</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">instance?.proxy?.$Bus.all.clear() </span><br></pre></td></tr></table></figure>

<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><p><strong>他的主要作用就是让开发者区分不同的运行环境，来实现 兼容开发和生产</strong></p>
<p><strong>例如 npm run dev 就是开发环境 npm run build 就是生产环境等等</strong></p>
<p><a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Vite&spm=1001.2101.3001.7020">Vite</a> 在一个特殊的 <strong><code>import.meta.env</code></strong> 对象上暴露环境变量。这里有一些在所有情况下都可以使用的内建变量</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;BASE_URL&quot;</span>:<span class="string">&quot;/&quot;</span>, <span class="comment">//部署时的URL前缀</span></span><br><span class="line">    <span class="attr">&quot;MODE&quot;</span>:<span class="string">&quot;development&quot;</span>, <span class="comment">//运行模式</span></span><br><span class="line">    <span class="attr">&quot;DEV&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;  //是否在dev环境</span></span><br><span class="line"><span class="attr">    PROD&quot;</span>:<span class="literal">false</span>, <span class="comment">//是否是build 环境</span></span><br><span class="line">    <span class="attr">&quot;SSR&quot;</span>:<span class="literal">false</span> <span class="comment">//是否是SSR 服务端渲染模式</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>需要注意的一点就是这个环境变量不能使用动态赋值import.meta.env[key] 因为这些环境变量在打包的时候是会被硬编码的通过JSON.stringify 注入浏览器的</strong></p>
<h3 id="配置额外的环境变量"><a href="#配置额外的环境变量" class="headerlink" title="配置额外的环境变量"></a>配置额外的环境变量</h3><p>在根目录新建env 文件 可以创建多个</p>
<p>格式：.env.development</p>
<p> 修改启动命令</p>
<p>在 package json 配置 –mode env文件名称()</p>
<p>配置智能提示:env.d.ts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface ImportMetaEnv &#123;</span><br><span class="line">    VITE_XIAOMAN:string</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>读取环境变量属性值</p>
<p>import.meta.env.VITE_XIAOMAN</p>
<h3 id="生产环境使用"><a href="#生产环境使用" class="headerlink" title="生产环境使用"></a>生产环境使用</h3><p>创建 .env.production 在执行npm run build 的时候他会自己加载这个文件 </p>
<h3 id="如果想在vite-config-ts-使用环境变量"><a href="#如果想在vite-config-ts-使用环境变量" class="headerlink" title="如果想在vite.config.ts 使用环境变量"></a><strong>如果想在vite.config.ts 使用环境变量</strong></h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fileURLToPath, URL &#125; <span class="keyword">from</span> <span class="string">&#x27;node:url&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig, loadEnv &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> vueJsx <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">// https://vitejs.dev/config/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;mode&#125;:<span class="built_in">any</span>) =&gt; &#123;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">console</span>.log(loadEnv(mode,process.cwd()))</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> defineConfig(&#123;</span><br><span class="line">    plugins: [vue(), vueJsx()],</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">        <span class="string">&#x27;@&#x27;</span>: fileURLToPath(<span class="keyword">new</span> URL(<span class="string">&#x27;./src&#x27;</span>, <span class="keyword">import</span>.meta.url))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="Proxy跨域"><a href="#Proxy跨域" class="headerlink" title="Proxy跨域"></a>Proxy跨域</h2><h3 id="什么是跨域"><a href="#什么是跨域" class="headerlink" title="什么是跨域"></a>什么是<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E8%B7%A8%E5%9F%9F&spm=1001.2101.3001.7020">跨域</a></h3><p>主要是出于浏览器的<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5&spm=1001.2101.3001.7020">同源策略</a>限制，它是浏览器最核心也最基本的安全功能。</p>
<p>当一个请求url的 <strong>协议、域名、端口</strong> 三者之间任意一个与当前页面url不同即为跨域。</p>
<h3 id="如何解决跨域"><a href="#如何解决跨域" class="headerlink" title="如何解决跨域"></a>如何解决跨域</h3><p>1.<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=jsonp&spm=1001.2101.3001.7020">jsonp</a> 这种方式在之前很常见，他实现的基本原理是利用了HTML里script元素标签没有跨域限制 动态创建script标签，将src作为服务器地址，服务器返回一个callback接受返回的参数</p>
<p>2.cors 设置 CORS 允许跨域资源共享 需要后端设置</p>
<p>3.使用Vite proxy 或者 node代理 或者 webpack proxy 他们三种方式都是代理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node 后端接口</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"> </span><br><span class="line"><span class="comment">//创建get请求</span></span><br><span class="line">app.get(<span class="string">&#x27;/xm&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">     res.json(&#123;</span><br><span class="line">        code:<span class="number">200</span>,</span><br><span class="line">        message:<span class="string">&quot;请求成功&quot;</span></span><br><span class="line">     &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//端口号9001</span></span><br><span class="line">app.listen(<span class="number">9001</span>)</span><br></pre></td></tr></table></figure>

<p>在vite.config.js/ts 进行配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">export default defineConfig(&#123;</span><br><span class="line">  plugins: [vue()],</span><br><span class="line">  server:&#123;</span><br><span class="line">     proxy:&#123;</span><br><span class="line">        &#39;&#x2F;api&#39;:&#123;</span><br><span class="line">            target:&quot;http:&#x2F;&#x2F;localhost:9001&#x2F;&quot;, &#x2F;&#x2F;跨域地址</span><br><span class="line">            changeOrigin:true, &#x2F;&#x2F;支持跨域</span><br><span class="line">            rewrite:(path) &#x3D;&gt; path.replace(&#x2F;^\&#x2F;api&#x2F;, &quot;&quot;)&#x2F;&#x2F;重写路径,替换&#x2F;api</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


      
       <hr><span style="font-style: italic;color: gray;"> --- </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2019-2022
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
